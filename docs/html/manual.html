<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChainGraph - äº§å“æ‰‹å†Œ</title>
    <style>

:root {
    --bg-color: #1a1a2e;
    --sidebar-bg: #16213e;
    --content-bg: #0f0f23;
    --text-color: #e4e4e4;
    --heading-color: #00d9ff;
    --link-color: #64b5f6;
    --code-bg: #2d2d4a;
    --border-color: #3d3d5c;
    --table-header-bg: #2a2a4a;
    --success-color: #4caf50;
}

* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
    background-color: var(--bg-color);
    color: var(--text-color);
    line-height: 1.6;
}

.container {
    display: flex;
    min-height: 100vh;
}

.sidebar {
    width: 280px;
    background-color: var(--sidebar-bg);
    border-right: 1px solid var(--border-color);
    position: fixed;
    height: 100vh;
    overflow-y: auto;
}

.sidebar-header {
    padding: 20px;
    border-bottom: 1px solid var(--border-color);
    background: linear-gradient(135deg, #1e3a5f 0%, #16213e 100%);
}

.sidebar-header h2 {
    color: var(--heading-color);
    font-size: 1.2rem;
}

.sidebar-content {
    padding: 15px;
}

.sidebar-content ul {
    list-style: none;
}

.sidebar-content li {
    margin: 5px 0;
}

.sidebar-content a {
    color: var(--text-color);
    text-decoration: none;
    font-size: 0.9rem;
    display: block;
    padding: 5px 10px;
    border-radius: 5px;
    transition: all 0.2s;
}

.sidebar-content a:hover {
    background-color: var(--code-bg);
    color: var(--heading-color);
}

.content {
    margin-left: 280px;
    padding: 40px 60px;
    max-width: 1000px;
    background-color: var(--content-bg);
    min-height: 100vh;
}

h1, h2, h3, h4, h5, h6 {
    color: var(--heading-color);
    margin: 1.5em 0 0.5em;
    font-weight: 600;
}

h1 {
    font-size: 2.5rem;
    border-bottom: 2px solid var(--heading-color);
    padding-bottom: 10px;
}

h2 {
    font-size: 1.8rem;
    border-bottom: 1px solid var(--border-color);
    padding-bottom: 8px;
}

h3 {
    font-size: 1.4rem;
}

h4 {
    font-size: 1.2rem;
}

p {
    margin: 1em 0;
}

a {
    color: var(--link-color);
    text-decoration: none;
}

a:hover {
    text-decoration: underline;
}

code {
    background-color: var(--code-bg);
    padding: 2px 6px;
    border-radius: 4px;
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
    font-size: 0.9em;
}

pre {
    background-color: var(--code-bg);
    padding: 15px 20px;
    border-radius: 8px;
    overflow-x: auto;
    margin: 1em 0;
    border: 1px solid var(--border-color);
}

pre code {
    background: none;
    padding: 0;
    font-size: 0.85rem;
    line-height: 1.5;
}

.table {
    width: 100%;
    border-collapse: collapse;
    margin: 1em 0;
}

.table th, .table td {
    border: 1px solid var(--border-color);
    padding: 10px 15px;
    text-align: left;
}

.table th {
    background-color: var(--table-header-bg);
    color: var(--heading-color);
    font-weight: 600;
}

.table tr:nth-child(even) {
    background-color: rgba(45, 45, 74, 0.3);
}

ul, ol {
    margin: 1em 0;
    padding-left: 2em;
}

li {
    margin: 0.5em 0;
}

hr {
    border: none;
    border-top: 1px solid var(--border-color);
    margin: 2em 0;
}

img {
    max-width: 100%;
    height: auto;
}

blockquote {
    border-left: 4px solid var(--heading-color);
    padding-left: 20px;
    margin: 1em 0;
    color: #aaa;
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
    .sidebar {
        display: none;
    }
    .content {
        margin-left: 0;
        padding: 20px;
    }
}

/* ä»£ç é«˜äº®åŸºç¡€æ ·å¼ */
.language-gql, .language-sql, .language-bash, .language-rust, .language-json {
    color: #a8d4ff;
}

/* æ‰“å°æ ·å¼ */
@media print {
    .sidebar {
        display: none;
    }
    .content {
        margin-left: 0;
        background: white;
        color: black;
    }
    h1, h2, h3, h4 {
        color: #333;
    }
    pre, code {
        background-color: #f5f5f5;
        border: 1px solid #ddd;
    }
}

    </style>
</head>
<body>
    <div class="container">
        <nav class="sidebar">
            <div class="sidebar-header">
                <h2>ğŸ“– å¯¼èˆª</h2>
            </div>
            <div class="sidebar-content" id="toc">
            </div>
        </nav>
        <main class="content">
<h1 id="chaingraph-äº§å“æ‰‹å†Œ">ChainGraph äº§å“æ‰‹å†Œ</h1>

<h2 id="ç›®å½•">ç›®å½•</h2>

<ol>
<li><a href="#1-äº§å“æ¦‚è¿°">äº§å“æ¦‚è¿°</a></li>
<li><a href="#2-ç³»ç»Ÿè¦æ±‚">ç³»ç»Ÿè¦æ±‚</a></li>
<li><a href="#3-å®‰è£…éƒ¨ç½²">å®‰è£…éƒ¨ç½²</a></li>
<li><a href="#4-æ ¸å¿ƒæ¦‚å¿µ">æ ¸å¿ƒæ¦‚å¿µ</a></li>
<li><a href="#5-æ•°æ®æ¨¡å‹">æ•°æ®æ¨¡å‹</a></li>
<li><a href="#6-gql-æŸ¥è¯¢è¯­è¨€">GQL æŸ¥è¯¢è¯­è¨€</a></li>
</ol>
<ul>
<li><a href="#61-è¯­æ³•æ¦‚è¿°">6.1 è¯­æ³•æ¦‚è¿°</a></li>
<li><a href="#62-match-è¯­å¥">6.2 MATCH è¯­å¥</a></li>
<li><a href="#63-where-å­å¥">6.3 WHERE å­å¥</a></li>
<li><a href="#64-return-å­å¥">6.4 RETURN å­å¥</a></li>
<li><a href="#65-order-by-å’Œ-limit">6.5 ORDER BY å’Œ LIMIT</a></li>
<li><a href="#66-insert-è¯­å¥">6.6 INSERT è¯­å¥</a></li>
<li><a href="#67-delete-è¯­å¥">6.7 DELETE è¯­å¥</a></li>
<li><a href="#68-update-è¯­å¥">6.8 UPDATE è¯­å¥</a></li>
<li><a href="#69-let-å˜é‡ç»‘å®š-iso-gql-39075">6.9 LET å˜é‡ç»‘å®š</a></li>
<li><a href="#610-for-è¿­ä»£è¯­å¥-iso-gql-39075">6.10 FOR è¿­ä»£è¯­å¥</a></li>
<li><a href="#611-filter-è¿‡æ»¤è¯­å¥-iso-gql-39075">6.11 FILTER è¿‡æ»¤è¯­å¥</a></li>
<li><a href="#612-select-æŸ¥è¯¢è¯­å¥-iso-gql-39075">6.12 SELECT æŸ¥è¯¢è¯­å¥</a></li>
<li><a href="#613-use-å›¾åˆ‡æ¢è¯­å¥-iso-gql-39075">6.13 USE å›¾åˆ‡æ¢è¯­å¥</a></li>
<li><a href="#614-å¤åˆæŸ¥è¯¢-iso-gql-39075">6.14 å¤åˆæŸ¥è¯¢</a></li>
<li><a href="#615-session-ä¼šè¯ç®¡ç†-iso-gql-39075">6.15 SESSION ä¼šè¯ç®¡ç†</a></li>
<li><a href="#616-transaction-äº‹åŠ¡æ§åˆ¶-iso-gql-39075">6.16 TRANSACTION äº‹åŠ¡æ§åˆ¶</a></li>
<li><a href="#617-createdrop-graph-type-iso-gql-39075">6.17 CREATE/DROP GRAPH TYPE</a></li>
<li><a href="#618-é‡åŒ–è·¯å¾„æ¨¡å¼-iso-gql-39075">6.18 é‡åŒ–è·¯å¾„æ¨¡å¼</a></li>
<li><a href="#619-show-è¯­å¥---æŸ¥çœ‹æ•°æ®åº“å¯¹è±¡">6.19 SHOW è¯­å¥</a></li>
<li><a href="#620-describe-è¯­å¥---æŸ¥çœ‹å¯¹è±¡è¯¦æƒ…">6.20 DESCRIBE è¯­å¥</a></li>
</ul>
<ol>
<li><a href="#7-å›¾ç®—æ³•">å›¾ç®—æ³•</a></li>
<li><a href="#8-rest-api-å‚è€ƒ">REST API å‚è€ƒ</a></li>
<li><a href="#9-æ•°æ®å¯¼å…¥">æ•°æ®å¯¼å…¥</a></li>
<li><a href="#10-å‘½ä»¤è¡Œå·¥å…·">å‘½ä»¤è¡Œå·¥å…·</a></li>
<li><a href="#11-æ€§èƒ½è°ƒä¼˜">æ€§èƒ½è°ƒä¼˜</a></li>
<li><a href="#12-æœ€ä½³å®è·µ">æœ€ä½³å®è·µ</a></li>
<li><a href="#13-æ•…éšœæ’é™¤">æ•…éšœæ’é™¤</a></li>
<li><a href="#é™„å½•">é™„å½•</a></li>
</ol>

<hr>

<h2 id="1-äº§å“æ¦‚è¿°">1. äº§å“æ¦‚è¿°</h2>

<h3 id="11-ä»€ä¹ˆæ˜¯-chaingraph">1.1 ä»€ä¹ˆæ˜¯ ChainGraph</h3>

<p>ChainGraph æ˜¯ä¸€æ¬¾ä¸“ä¸º Web3 åœºæ™¯è®¾è®¡çš„é«˜æ€§èƒ½å›¾æ•°æ®åº“ã€‚å®ƒä¸“æ³¨äºåŒºå—é“¾æ•°æ®çš„å­˜å‚¨ã€æŸ¥è¯¢å’Œåˆ†æï¼Œç‰¹åˆ«é€‚ç”¨äºï¼š</p>

<ul>
<li><strong>é“¾è·¯è¿½è¸ª</strong>ï¼šè¿½è¸ªèµ„é‡‘æµå‘ï¼Œå‘ç°åœ°å€ä¹‹é—´çš„å…³è”å…³ç³»</li>
<li><strong>åæ´—é’±åˆ†æ</strong>ï¼šæ£€æµ‹å¯ç–‘äº¤æ˜“æ¨¡å¼ï¼Œè¯†åˆ«æ··å¸è¡Œä¸º</li>
<li><strong>æ™ºèƒ½åˆçº¦åˆ†æ</strong>ï¼šåˆ†æåˆçº¦è°ƒç”¨å…³ç³»å’Œä¾èµ–å›¾</li>
<li><strong>DeFi ç›‘æ§</strong>ï¼šç›‘æ§ DeFi åè®®çš„èµ„é‡‘æµåŠ¨</li>
</ul>

<h3 id="12-æ ¸å¿ƒä¼˜åŠ¿">1.2 æ ¸å¿ƒä¼˜åŠ¿</h3>

<table class="table">
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>SSD ä¼˜åŒ–</strong></td>
<td>4KB é¡µé¢å¯¹é½ï¼Œæœ€å¤§åŒ– SSD æ€§èƒ½</td>
</tr>
<tr>
<th><strong>æµ·é‡æ•°æ®</strong></th>
<th>æ”¯æŒå­˜å‚¨æ•°åäº¿é¡¶ç‚¹å’Œè¾¹</th>
</tr>
<tr>
<th><strong>å®æ—¶åˆ†æ</strong></th>
<th>æ¯«ç§’çº§è·¯å¾„æŸ¥è¯¢å’Œå›¾åˆ†æ</th>
</tr>
<tr>
<th><strong>Web3 åŸç”Ÿ</strong></th>
<th>å†…ç½®åŒºå—é“¾ä¸“ç”¨æ•°æ®ç±»å‹</th>
</tr>
<tr>
<th><strong>æ ‡å‡†æŸ¥è¯¢</strong></th>
<th>åŸºäº ISO GQL 39075 æ ‡å‡†</th>
</tr>
</tbody>
</table>

<h3 id="13-å…¸å‹åº”ç”¨åœºæ™¯">1.3 å…¸å‹åº”ç”¨åœºæ™¯</h3>

<pre><code>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ChainGraph åº”ç”¨åœºæ™¯                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   å®‰å…¨åˆè§„      â”‚    ä¸šåŠ¡åˆ†æ     â”‚      é£é™©æ§åˆ¶           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ åæ´—é’±æ£€æµ‹    â”‚ â€¢ ç”¨æˆ·ç”»åƒ      â”‚ â€¢ æ¬ºè¯ˆæ£€æµ‹              â”‚
â”‚ â€¢ åˆ¶è£ç­›æŸ¥      â”‚ â€¢ äº¤æ˜“åˆ†æ      â”‚ â€¢ å¼‚å¸¸è¡Œä¸ºè¯†åˆ«          â”‚
â”‚ â€¢ åˆè§„æŠ¥å‘Š      â”‚ â€¢ å¸‚åœºç›‘æ§      â”‚ â€¢ é£é™©è¯„ä¼°              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>

<hr>

<h2 id="2-ç³»ç»Ÿè¦æ±‚">2. ç³»ç»Ÿè¦æ±‚</h2>

<h3 id="21-ç¡¬ä»¶è¦æ±‚">2.1 ç¡¬ä»¶è¦æ±‚</h3>

<table class="table">
<thead>
<tr>
<th>ç»„ä»¶</th>
<th>æœ€ä½é…ç½®</th>
<th>æ¨èé…ç½®</th>
</tr>
</thead>
<tbody>
<tr>
<td>CPU</td>
<td>4 æ ¸</td>
<td>8 æ ¸ä»¥ä¸Š</td>
</tr>
<tr>
<th>å†…å­˜</th>
<th>8 GB</th>
<th>32 GB ä»¥ä¸Š</th>
</tr>
<tr>
<th>å­˜å‚¨</th>
<th>100 GB SSD</th>
<th>1 TB NVMe SSD</th>
</tr>
<tr>
<th>ç½‘ç»œ</th>
<th>100 Mbps</th>
<th>1 Gbps</th>
</tr>
</tbody>
</table>

<h3 id="22-è½¯ä»¶è¦æ±‚">2.2 è½¯ä»¶è¦æ±‚</h3>

<table class="table">
<thead>
<tr>
<th>è½¯ä»¶</th>
<th>ç‰ˆæœ¬è¦æ±‚</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ“ä½œç³»ç»Ÿ</td>
<td>Linux (æ¨è) / macOS / Windows</td>
</tr>
<tr>
<th>Rust</th>
<th>1.70+</th>
</tr>
<tr>
<th>æ–‡ä»¶ç³»ç»Ÿ</th>
<th>ext4 / xfs / APFS</th>
</tr>
</tbody>
</table>

<h3 id="23-ç«¯å£è¦æ±‚">2.3 ç«¯å£è¦æ±‚</h3>

<table class="table">
<thead>
<tr>
<th>ç«¯å£</th>
<th>ç”¨é€”</th>
</tr>
</thead>
<tbody>
<tr>
<td>8080</td>
<td>HTTP API æœåŠ¡</td>
</tr>
</tbody>
</table>

<hr>

<h2 id="3-å®‰è£…éƒ¨ç½²">3. å®‰è£…éƒ¨ç½²</h2>

<h3 id="31-ä»æºç ç¼–è¯‘">3.1 ä»æºç ç¼–è¯‘</h3>

<pre><code class="language-bash">
# 1. å…‹éš†ä»“åº“
git clone https://github.com/your-org/chaingraph.git
cd chaingraph

# 2. ç¼–è¯‘ Release ç‰ˆæœ¬
cargo build --release

# 3. å¯æ‰§è¡Œæ–‡ä»¶ä½äº
ls target/release/chaingraph-*
# chaingraph-server  - HTTP æœåŠ¡å™¨
# chaingraph-cli     - å‘½ä»¤è¡Œå·¥å…·
# chaingraph-import  - æ•°æ®å¯¼å…¥å·¥å…·
</code></pre>

<h3 id="32-ç›®å½•ç»“æ„">3.2 ç›®å½•ç»“æ„</h3>

<pre><code>
chaingraph/
â”œâ”€â”€ target/release/
â”‚   â”œâ”€â”€ chaingraph-server    # æœåŠ¡å™¨
â”‚   â”œâ”€â”€ chaingraph-cli       # CLI å·¥å…·
â”‚   â””â”€â”€ chaingraph-import    # å¯¼å…¥å·¥å…·
â””â”€â”€ data/                    # æ•°æ®ç›®å½•ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰
    â”œâ”€â”€ chaingraph.data      # æ•°æ®æ–‡ä»¶
    â””â”€â”€ chaingraph.meta      # å…ƒæ•°æ®æ–‡ä»¶
</code></pre>

<h3 id="33-å¯åŠ¨æœåŠ¡">3.3 å¯åŠ¨æœåŠ¡</h3>

<pre><code class="language-bash">
# åŸºæœ¬å¯åŠ¨
./chaingraph-server

# å®Œæ•´å‚æ•°
./chaingraph-server \
    --data-dir /data/chaingraph \
    --host 0.0.0.0 \
    --port 8080 \
    --buffer-size 2048
</code></pre>

<h3 id="34-æœåŠ¡éªŒè¯">3.4 æœåŠ¡éªŒè¯</h3>

<pre><code class="language-bash">
# å¥åº·æ£€æŸ¥
curl http://localhost:8080/health

# é¢„æœŸå“åº”
{"status": "ok", "version": "0.1.0"}
</code></pre>

<hr>

<h2 id="4-æ ¸å¿ƒæ¦‚å¿µ">4. æ ¸å¿ƒæ¦‚å¿µ</h2>

<h3 id="41-å›¾æ¨¡å‹">4.1 å›¾æ¨¡å‹</h3>

<p>ChainGraph ä½¿ç”¨å±æ€§å›¾æ¨¡å‹ï¼ˆProperty Graph Modelï¼‰ï¼š</p>

<pre><code>
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚     Vertex      â”‚          â”‚      Edge       â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚ â€¢ ID            â”‚          â”‚ â€¢ ID            â”‚
     â”‚ â€¢ Label         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ â€¢ Label         â”‚
     â”‚ â€¢ Properties    â”‚          â”‚ â€¢ Source        â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚ â€¢ Target        â”‚
                                  â”‚ â€¢ Properties    â”‚
                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>

<h3 id="42-é¡¶ç‚¹vertex">4.2 é¡¶ç‚¹ï¼ˆVertexï¼‰</h3>

<p>é¡¶ç‚¹ä»£è¡¨åŒºå—é“¾ä¸­çš„å®ä½“ï¼š</p>

<pre><code class="language-rust">
Vertex {
    id: VertexId,           // å”¯ä¸€æ ‡è¯†
    label: VertexLabel,     // ç±»å‹æ ‡ç­¾
    address: Address,       // åŒºå—é“¾åœ°å€
    properties: Properties, // å±æ€§é›†åˆ
}
</code></pre>

<h3 id="43-è¾¹edge">4.3 è¾¹ï¼ˆEdgeï¼‰</h3>

<p>è¾¹ä»£è¡¨å®ä½“ä¹‹é—´çš„å…³ç³»ï¼š</p>

<pre><code class="language-rust">
Edge {
    id: EdgeId,             // å”¯ä¸€æ ‡è¯†
    label: EdgeLabel,       // ç±»å‹æ ‡ç­¾
    source: VertexId,       // èµ·ç‚¹
    target: VertexId,       // ç»ˆç‚¹
    properties: Properties, // å±æ€§é›†åˆ
}
</code></pre>

<h3 id="44-å±æ€§ç±»å‹">4.4 å±æ€§ç±»å‹</h3>

<table class="table">
<thead>
<tr>
<th>ç±»å‹</th>
<th>Rust ç±»å‹</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Null</code></td>
<td><code>()</code></td>
<td>ç©ºå€¼</td>
</tr>
<tr>
<th><code>Bool</code></th>
<th><code>bool</code></th>
<th>å¸ƒå°”å€¼</th>
</tr>
<tr>
<th><code>Int</code></th>
<th><code>i64</code></th>
<th>64ä½æ•´æ•°</th>
</tr>
<tr>
<th><code>UInt</code></th>
<th><code>u64</code></th>
<th>64ä½æ— ç¬¦å·æ•´æ•°</th>
</tr>
<tr>
<th><code>Float</code></th>
<th><code>f64</code></th>
<th>64ä½æµ®ç‚¹æ•°</th>
</tr>
<tr>
<th><code>String</code></th>
<th><code>String</code></th>
<th>å­—ç¬¦ä¸²</th>
</tr>
<tr>
<th><code>Address</code></th>
<th><code>H160</code></th>
<th>ä»¥å¤ªåŠåœ°å€</th>
</tr>
<tr>
<th><code>TxHash</code></th>
<th><code>H256</code></th>
<th>äº¤æ˜“å“ˆå¸Œ</th>
</tr>
<tr>
<th><code>Amount</code></th>
<th><code>U256</code></th>
<th>ä»£å¸é‡‘é¢</th>
</tr>
<tr>
<th><code>Timestamp</code></th>
<th><code>i64</code></th>
<th>Unix æ—¶é—´æˆ³</th>
</tr>
<tr>
<th><code>Bytes</code></th>
<th><code>Vec<u8></code></th>
<th>å­—èŠ‚æ•°ç»„</th>
</tr>
<tr>
<th><code>List</code></th>
<th><code>Vec<PropertyValue></code></th>
<th>åˆ—è¡¨</th>
</tr>
<tr>
<th><code>Map</code></th>
<th><code>HashMap<String, PropertyValue></code></th>
<th>æ˜ å°„</th>
</tr>
</tbody>
</table>

<hr>

<h2 id="5-æ•°æ®æ¨¡å‹">5. æ•°æ®æ¨¡å‹</h2>

<h3 id="51-é¡¶ç‚¹ç±»å‹">5.1 é¡¶ç‚¹ç±»å‹</h3>

<h4 id="accountè´¦æˆ·">Accountï¼ˆè´¦æˆ·ï¼‰</h4>

<p>è¡¨ç¤ºå¤–éƒ¨æ‹¥æœ‰è´¦æˆ·ï¼ˆEOAï¼‰ã€‚</p>

<pre><code class="language-json">
{
  "label": "Account",
  "address": "0x742d35Cc6634C0532925a3b844Bc9e7595f3fBb0",
  "properties": {
    "balance": "1000000000000000000",
    "nonce": 42,
    "first_seen_block": 12000000,
    "last_active_block": 15000000,
    "tx_count": 156
  }
}
</code></pre>

<h4 id="contractåˆçº¦">Contractï¼ˆåˆçº¦ï¼‰</h4>

<p>è¡¨ç¤ºæ™ºèƒ½åˆçº¦ã€‚</p>

<pre><code class="language-json">
{
  "label": "Contract",
  "address": "0xdAC17F958D2ee523a2206206994597C13D831ec7",
  "properties": {
    "name": "TetherToken",
    "symbol": "USDT",
    "decimals": 6,
    "creator": "0x...",
    "creation_block": 4634748,
    "is_verified": true
  }
}
</code></pre>

<h4 id="tokenä»£å¸">Tokenï¼ˆä»£å¸ï¼‰</h4>

<p>è¡¨ç¤º ERC20/ERC721 ç­‰ä»£å¸ã€‚</p>

<pre><code class="language-json">
{
  "label": "Token",
  "address": "0xA0b86a33E6dC663CDA4e0A....",
  "properties": {
    "name": "USD Coin",
    "symbol": "USDC",
    "decimals": 6,
    "total_supply": "1000000000000000"
  }
}
</code></pre>

<h4 id="transactionäº¤æ˜“">Transactionï¼ˆäº¤æ˜“ï¼‰</h4>

<p>è¡¨ç¤ºé“¾ä¸Šäº¤æ˜“ã€‚</p>

<pre><code class="language-json">
{
  "label": "Transaction",
  "properties": {
    "hash": "0x...",
    "block_number": 15000000,
    "from": "0x...",
    "to": "0x...",
    "value": "1000000000000000000",
    "gas_used": 21000,
    "gas_price": "50000000000",
    "status": 1
  }
}
</code></pre>

<h4 id="blockåŒºå—">Blockï¼ˆåŒºå—ï¼‰</h4>

<p>è¡¨ç¤ºåŒºå—ã€‚</p>

<pre><code class="language-json">
{
  "label": "Block",
  "properties": {
    "number": 15000000,
    "hash": "0x...",
    "parent_hash": "0x...",
    "timestamp": 1660000000,
    "miner": "0x...",
    "gas_limit": 30000000,
    "gas_used": 15000000,
    "tx_count": 200
  }
}
</code></pre>

<h3 id="52-è¾¹ç±»å‹">5.2 è¾¹ç±»å‹</h3>

<h4 id="transferè½¬è´¦">Transferï¼ˆè½¬è´¦ï¼‰</h4>

<p>è¡¨ç¤ºä»£å¸è½¬è´¦ã€‚</p>

<pre><code class="language-json">
{
  "label": "Transfer",
  "source": 1,
  "target": 2,
  "properties": {
    "amount": "1000000000000000000",
    "token": "0xdAC17F958D2ee523a2206206994597C13D831ec7",
    "tx_hash": "0x...",
    "block_number": 15000000,
    "log_index": 0
  }
}
</code></pre>

<h4 id="callè°ƒç”¨">Callï¼ˆè°ƒç”¨ï¼‰</h4>

<p>è¡¨ç¤ºåˆçº¦è°ƒç”¨ã€‚</p>

<pre><code class="language-json">
{
  "label": "Call",
  "source": 1,
  "target": 2,
  "properties": {
    "method": "transfer(address,uint256)",
    "tx_hash": "0x...",
    "gas_used": 50000,
    "success": true
  }
}
</code></pre>

<h4 id="createåˆ›å»º">Createï¼ˆåˆ›å»ºï¼‰</h4>

<p>è¡¨ç¤ºåˆçº¦åˆ›å»ºã€‚</p>

<pre><code class="language-json">
{
  "label": "Create",
  "source": 1,
  "target": 2,
  "properties": {
    "tx_hash": "0x...",
    "block_number": 15000000
  }
}
</code></pre>

<h4 id="approveæˆæƒ">Approveï¼ˆæˆæƒï¼‰</h4>

<p>è¡¨ç¤º ERC20 æˆæƒã€‚</p>

<pre><code class="language-json">
{
  "label": "Approve",
  "source": 1,
  "target": 2,
  "properties": {
    "amount": "115792089237316195423570985008687907853269984665640564039457584007913129639935",
    "token": "0x...",
    "tx_hash": "0x..."
  }
}
</code></pre>

<hr>

<h2 id="6-gql-æŸ¥è¯¢è¯­è¨€">6. GQL æŸ¥è¯¢è¯­è¨€</h2>

<h3 id="61-è¯­æ³•æ¦‚è¿°">6.1 è¯­æ³•æ¦‚è¿°</h3>

<p>ChainGraph æ”¯æŒåŸºäº ISO GQL 39075 æ ‡å‡†çš„æŸ¥è¯¢è¯­è¨€ã€‚</p>

<pre><code>
GQL è¯­å¥ ::= MATCH æ¨¡å¼ [WHERE æ¡ä»¶] RETURN è¿”å›é¡¹ [ORDER BY æ’åº] [LIMIT é™åˆ¶]
           | INSERT æ¨¡å¼
           | DELETE æ¨¡å¼
           | UPDATE æ¨¡å¼ SET å±æ€§
</code></pre>

<h3 id="62-match-è¯­å¥">6.2 MATCH è¯­å¥</h3>

<h4 id="åŸºæœ¬èŠ‚ç‚¹åŒ¹é…">åŸºæœ¬èŠ‚ç‚¹åŒ¹é…</h4>

<pre><code class="language-gql">
-- åŒ¹é…æ‰€æœ‰è´¦æˆ·
MATCH (n:Account) RETURN n

-- åŒ¹é…æŒ‡å®šåœ°å€çš„è´¦æˆ·
MATCH (n:Account {address: "0x742d35Cc..."}) RETURN n

-- åŒ¹é…å¤šç§ç±»å‹ï¼ˆæ ‡ç­¾æå–ï¼‰
MATCH (n:Account|Contract) RETURN n

-- åŒ¹é…åŒæ—¶å…·æœ‰å¤šä¸ªæ ‡ç­¾çš„èŠ‚ç‚¹ï¼ˆæ ‡ç­¾åˆå–ï¼‰
MATCH (n:Account&amp;HighValue) RETURN n

-- æ’é™¤ç‰¹å®šæ ‡ç­¾ï¼ˆæ ‡ç­¾å¦å®šï¼‰
MATCH (n:!Contract) RETURN n

-- é€šé…ç¬¦æ ‡ç­¾ï¼ˆåŒ¹é…ä»»æ„æ ‡ç­¾ï¼‰
MATCH (n:%) RETURN n
</code></pre>

<h4 id="å…³ç³»åŒ¹é…">å…³ç³»åŒ¹é…</h4>

<p>ChainGraph æ”¯æŒ ISO GQL 39075 æ ‡å‡†çš„æ‰€æœ‰ 7 ç§è¾¹æ–¹å‘ç±»å‹ï¼š</p>

<pre><code class="language-gql">
-- å‡ºå‘è¾¹: -[...]-&gt;
MATCH (a:Account)-[t:Transfer]-&gt;(b:Account) RETURN a, t, b

-- å…¥å‘è¾¹: &lt;-[...]-
MATCH (a:Account)&lt;-[t:Transfer]-(b:Account) RETURN a, t, b

-- ä»»æ„æ–¹å‘: -[...]-
MATCH (a:Account)-[t:Transfer]-(b:Account) RETURN a, t, b

-- æ— å‘è¾¹: ~[...]~
MATCH (a:Account)~[t:Transfer]~(b:Account) RETURN a, t, b

-- åŒå‘è¾¹ï¼ˆå·¦æˆ–å³ï¼‰: &lt;-[...]-&gt;
MATCH (a:Account)&lt;-[t:Transfer]-&gt;(b:Account) RETURN a, t, b

-- å·¦æˆ–æ— å‘: &lt;~[...]~
MATCH (a:Account)&lt;~[t:Transfer]~(b:Account) RETURN a, t, b

-- æ— å‘æˆ–å³: ~[...]~&gt;
MATCH (a:Account)~[t:Transfer]~&gt;(b:Account) RETURN a, t, b
</code></pre>

<h4 id="è·¯å¾„åŒ¹é…">è·¯å¾„åŒ¹é…</h4>

<pre><code class="language-gql">
-- å¯å˜é•¿åº¦è·¯å¾„ï¼ˆ1åˆ°5è·³ï¼ŒISO GQL 39075 è¯­æ³•ï¼‰
MATCH (a)-[:Transfer]-&gt;{1,5}(b) RETURN a, b

-- æŒ‡å®šé•¿åº¦è·¯å¾„ï¼ˆç²¾ç¡®3è·³ï¼‰
MATCH (a)-[:Transfer]-&gt;{3}(b) RETURN a, b
</code></pre>

<h3 id="63-where-å­å¥">6.3 WHERE å­å¥</h3>

<pre><code class="language-gql">
-- æ•°å€¼æ¯”è¾ƒ
MATCH (n:Account) WHERE n.balance &gt; 1000000000000000000 RETURN n

-- å­—ç¬¦ä¸²åŒ¹é…
MATCH (n:Contract) WHERE n.name = "TetherToken" RETURN n

-- é€»è¾‘è¿ç®—
MATCH (n:Account) 
WHERE n.balance &gt; 1000 AND n.tx_count &gt; 10 
RETURN n

-- åœ°å€è¿‡æ»¤
MATCH (a)-[t:Transfer]-&gt;(b) 
WHERE a.address = "0x..." 
RETURN b, t.amount
</code></pre>

<h3 id="64-return-å­å¥">6.4 RETURN å­å¥</h3>

<pre><code class="language-gql">
-- è¿”å›èŠ‚ç‚¹
MATCH (n:Account) RETURN n

-- è¿”å›å±æ€§
MATCH (n:Account) RETURN n.address, n.balance

-- è¿”å›åˆ«å
MATCH (n:Account) RETURN n.address AS addr, n.balance AS bal

-- è¿”å›è·¯å¾„
MATCH path = (a)-[:Transfer*]-&gt;(b) RETURN path
</code></pre>

<h3 id="65-order-by-å’Œ-limit">6.5 ORDER BY å’Œ LIMIT</h3>

<pre><code class="language-gql">
-- æ’åº
MATCH (n:Account) 
RETURN n 
ORDER BY n.balance DESC

-- é™åˆ¶ç»“æœ
MATCH (n:Account) 
RETURN n 
LIMIT 100

-- åˆ†é¡µ
MATCH (n:Account) 
RETURN n 
ORDER BY n.balance DESC 
SKIP 100 LIMIT 50
</code></pre>

<h3 id="66-insert-è¯­å¥">6.6 INSERT è¯­å¥</h3>

<p>INSERT è¯­å¥ç”¨äºæ’å…¥é¡¶ç‚¹å’Œè¾¹ï¼Œæ”¯æŒå¤šç§è¯­æ³•æ ¼å¼ã€‚</p>

<h4 id="æ’å…¥é¡¶ç‚¹">æ’å…¥é¡¶ç‚¹</h4>

<pre><code class="language-gql">
-- æ’å…¥å¸¦æ ‡ç­¾çš„é¡¶ç‚¹
INSERT (n:Account)

-- æ’å…¥å¸¦å±æ€§çš„é¡¶ç‚¹
INSERT (n:Account {address: "0x742d35Cc6634C0532925a3b844Bc9e7595f3fBb0"})

-- æ’å…¥å¸¦å¤šä¸ªå±æ€§çš„é¡¶ç‚¹
INSERT (alice:Account {
    address: "0x742d35Cc6634C0532925a3b844Bc9e7595f3fBb0",
    name: "Alice",
    balance: 10000
})

-- æ’å…¥åˆçº¦é¡¶ç‚¹
INSERT (uniswap:Contract {
    address: "0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D",
    name: "Uniswap V2 Router"
})
</code></pre>

<h4 id="æ’å…¥è¾¹è½¬è´¦å…³ç³»">æ’å…¥è¾¹ï¼ˆè½¬è´¦å…³ç³»ï¼‰</h4>

<pre><code class="language-gql">
-- æ’å…¥å¸¦å±æ€§çš„è¾¹
INSERT (a:Account {address: "0xAAA..."})-[t:Transfer {amount: 1000}]-&gt;(b:Account {address: "0xBBB..."})

-- æ’å…¥å¸¦å®Œæ•´å±æ€§çš„è½¬è´¦è¾¹
INSERT (a:Account {address: "0x742d35Cc6634C0532925a3b844Bc9e7595f3fBb0"})
       -[t:Transfer {amount: 1000, block: 18500000}]-&gt;
       (b:Account {address: "0x8ba1f109551bD432803012645Ac136ddd64DBA72"})
</code></pre>

<h4 id="è¾¹å±æ€§è¯´æ˜">è¾¹å±æ€§è¯´æ˜</h4>

<table class="table">
<thead>
<tr>
<th>å±æ€§</th>
<th>ç±»å‹</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>amount</code> æˆ– <code>value</code></td>
<td>æ•´æ•°</td>
<td>è½¬è´¦é‡‘é¢</td>
</tr>
<tr>
<th><code>block</code> æˆ– <code>block_number</code></th>
<th>æ•´æ•°</th>
<th>åŒºå—é«˜åº¦</th>
</tr>
</tbody>
</table>

<p><strong>æ³¨æ„</strong>ï¼šæ’å…¥è¾¹æ—¶ï¼Œå¦‚æœé¡¶ç‚¹å·²å­˜åœ¨ï¼ˆé€šè¿‡ address åŒ¹é…ï¼‰ï¼Œä¼šè‡ªåŠ¨å¤ç”¨ç°æœ‰é¡¶ç‚¹ã€‚</p>

<h3 id="67-delete-è¯­å¥">6.7 DELETE è¯­å¥</h3>

<pre><code class="language-gql">
-- åˆ é™¤é¡¶ç‚¹
MATCH (n:Account {address: "0x..."}) DELETE n

-- åˆ é™¤è¾¹
MATCH (a)-[t:Transfer]-&gt;(b) WHERE t.amount &lt; 100 DELETE t
</code></pre>

<h3 id="68-update-è¯­å¥">6.8 UPDATE è¯­å¥</h3>

<pre><code class="language-gql">
-- æ›´æ–°å±æ€§
MATCH (n:Account {address: "0x..."}) 
SET n.balance = 2000000000000000000
</code></pre>

<h3 id="69-let-å˜é‡ç»‘å®š-iso-gql-39075">6.9 LET å˜é‡ç»‘å®š (ISO GQL 39075)</h3>

<p>LET è¯­å¥ç”¨äºå£°æ˜å’Œç»‘å®šå˜é‡ï¼Œæ”¯æŒå•ä¸ªæˆ–å¤šä¸ªå˜é‡åŒæ—¶ç»‘å®šã€‚</p>

<pre><code class="language-gql">
-- å•ä¸ªå˜é‡ç»‘å®š
LET x = 10

-- å¤šä¸ªå˜é‡ç»‘å®š
LET x = 10, name = "Alice", active = true

-- ä½¿ç”¨è¡¨è¾¾å¼
LET total = 100, rate = 0.08, result = 1 + 2

-- å¸ƒå°”å˜é‡
LET is_active = true, is_verified = false
</code></pre>

<h4 id="æ”¯æŒçš„æ•°æ®ç±»å‹">æ”¯æŒçš„æ•°æ®ç±»å‹</h4>

<table class="table">
<thead>
<tr>
<th>ç±»å‹</th>
<th>ç¤ºä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ•´æ•°</td>
<td><code>LET x = 42</code></td>
</tr>
<tr>
<th>æµ®ç‚¹æ•°</th>
<th><code>LET pi = 3.14</code></th>
</tr>
<tr>
<th>å­—ç¬¦ä¸²</th>
<th><code>LET name = "Alice"</code></th>
</tr>
<tr>
<th>å¸ƒå°”å€¼</th>
<th><code>LET active = true</code></th>
</tr>
</tbody>
</table>

<h3 id="610-for-è¿­ä»£è¯­å¥-iso-gql-39075">6.10 FOR è¿­ä»£è¯­å¥ (ISO GQL 39075)</h3>

<p>FOR è¯­å¥ç”¨äºåœ¨åˆ—è¡¨æˆ–èŒƒå›´ä¸Šè¿›è¡Œè¿­ä»£ï¼Œæ”¯æŒåºæ•°å˜é‡ã€‚</p>

<pre><code class="language-gql">
-- åŸºæœ¬è¿­ä»£
FOR x IN [1, 2, 3, 4, 5]

-- ä½¿ç”¨ range() å‡½æ•°
FOR i IN range(1, 10)

-- å¸¦åºæ•°å˜é‡çš„è¿­ä»£
FOR item IN [10, 20, 30] WITH ORDINALITY AS ord

-- ç»¼åˆç¤ºä¾‹
FOR i IN range(0, 100) WITH ORDINALITY AS idx
</code></pre>

<h4 id="range-å‡½æ•°">range() å‡½æ•°</h4>

<p><code>range(start, end)</code> å‡½æ•°ç”Ÿæˆä» <code>start</code> åˆ° <code>end-1</code> çš„æ•´æ•°åˆ—è¡¨ã€‚</p>

<pre><code class="language-gql">
-- range(1, 5) ç”Ÿæˆ [1, 2, 3, 4]
FOR i IN range(1, 5)

-- range(0, 3) ç”Ÿæˆ [0, 1, 2]
FOR i IN range(0, 3)
</code></pre>

<h3 id="611-filter-è¿‡æ»¤è¯­å¥-iso-gql-39075">6.11 FILTER è¿‡æ»¤è¯­å¥ (ISO GQL 39075)</h3>

<p>FILTER è¯­å¥ç”¨äºåŸºäºæ¡ä»¶è¿‡æ»¤ç»“æœã€‚</p>

<pre><code class="language-gql">
-- åŸºæœ¬è¿‡æ»¤
FILTER n.age &gt; 18

-- ç›¸ç­‰æ¯”è¾ƒ
FILTER n.status = "active"

-- å¤åˆæ¡ä»¶ (AND)
FILTER n.balance &gt; 1000 AND n.tx_count &gt; 10

-- å¤åˆæ¡ä»¶ (OR)
FILTER n.type = "Account" OR n.type = "Contract"

-- NOT æ¡ä»¶
FILTER NOT n.deleted

-- å¤æ‚è¡¨è¾¾å¼
FILTER n.amount &gt; 1000 AND (n.status = "pending" OR n.priority = "high")
</code></pre>

<h4 id="æ”¯æŒçš„æ¯”è¾ƒè¿ç®—ç¬¦">æ”¯æŒçš„æ¯”è¾ƒè¿ç®—ç¬¦</h4>

<table class="table">
<thead>
<tr>
<th>è¿ç®—ç¬¦</th>
<th>æè¿°</th>
<th>ç¤ºä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>=</code></td>
<td>ç›¸ç­‰</td>
<td><code>FILTER n.status = "active"</code></td>
</tr>
<tr>
<th><code><></code> æˆ– <code>!=</code></th>
<th>ä¸ç­‰</th>
<th><code>FILTER n.type <> "test"</code></th>
</tr>
<tr>
<th><code>></code></th>
<th>å¤§äº</th>
<th><code>FILTER n.balance > 1000</code></th>
</tr>
<tr>
<th><code><</code></th>
<th>å°äº</th>
<th><code>FILTER n.age < 30</code></th>
</tr>
<tr>
<th><code>>=</code></th>
<th>å¤§äºç­‰äº</th>
<th><code>FILTER n.score >= 60</code></th>
</tr>
<tr>
<th><code><=</code></th>
<th>å°äºç­‰äº</th>
<th><code>FILTER n.count <= 100</code></th>
</tr>
</tbody>
</table>

<h3 id="612-select-æŸ¥è¯¢è¯­å¥-iso-gql-39075">6.12 SELECT æŸ¥è¯¢è¯­å¥ (ISO GQL 39075)</h3>

<p>SELECT è¯­å¥æä¾› SQL é£æ ¼çš„æŸ¥è¯¢åŠŸèƒ½ï¼Œæ”¯æŒ DISTINCTã€GROUP BYã€HAVINGã€ORDER BYã€LIMIT å’Œ OFFSETã€‚</p>

<h4 id="åŸºæœ¬-select">åŸºæœ¬ SELECT</h4>

<pre><code class="language-gql">
-- é€‰æ‹©å±æ€§
SELECT n.name, n.age

-- ä½¿ç”¨åˆ«å
SELECT n.name AS name, n.balance AS amount

-- æ‰€æœ‰å±æ€§
SELECT *
</code></pre>

<h4 id="distinct-å»é‡">DISTINCT å»é‡</h4>

<pre><code class="language-gql">
-- å»é™¤é‡å¤å€¼
SELECT DISTINCT n.type

-- å¤šåˆ—å»é‡
SELECT DISTINCT n.category, n.status
</code></pre>

<h4 id="group-by-åˆ†ç»„">GROUP BY åˆ†ç»„</h4>

<pre><code class="language-gql">
-- åŸºæœ¬åˆ†ç»„
SELECT n.type, COUNT(*) 
GROUP BY n.type

-- å¤šåˆ—åˆ†ç»„
SELECT n.category, n.status, COUNT(*)
GROUP BY n.category, n.status

-- å¸¦èšåˆå‡½æ•°
SELECT n.type, SUM(n.amount), AVG(n.balance)
GROUP BY n.type
</code></pre>

<h4 id="having-åˆ†ç»„è¿‡æ»¤">HAVING åˆ†ç»„è¿‡æ»¤</h4>

<pre><code class="language-gql">
-- è¿‡æ»¤åˆ†ç»„ç»“æœ
SELECT n.type, COUNT(*) AS cnt
GROUP BY n.type
HAVING COUNT(*) &gt; 5

-- å¤æ‚ HAVING
SELECT n.category, SUM(n.amount) AS total
GROUP BY n.category
HAVING SUM(n.amount) &gt; 10000 AND COUNT(*) &gt;= 3
</code></pre>

<h4 id="order-by-æ’åº">ORDER BY æ’åº</h4>

<pre><code class="language-gql">
-- å‡åºæ’åºï¼ˆé»˜è®¤ï¼‰
SELECT n.name, n.created_at
ORDER BY n.created_at

-- é™åºæ’åº
SELECT n.name, n.balance
ORDER BY n.balance DESC

-- å¤šåˆ—æ’åº
SELECT n.category, n.name, n.priority
ORDER BY n.category ASC, n.priority DESC
</code></pre>

<h4 id="limit-å’Œ-offset-åˆ†é¡µ">LIMIT å’Œ OFFSET åˆ†é¡µ</h4>

<pre><code class="language-gql">
-- é™åˆ¶ç»“æœæ•°é‡
SELECT n.name
LIMIT 10

-- åˆ†é¡µæŸ¥è¯¢
SELECT n.name, n.created_at
ORDER BY n.created_at DESC
LIMIT 20 OFFSET 40

-- ç»“åˆæ‰€æœ‰åŠŸèƒ½
SELECT n.type, COUNT(*) AS cnt
GROUP BY n.type
HAVING COUNT(*) &gt; 5
ORDER BY cnt DESC
LIMIT 10 OFFSET 0
</code></pre>

<h4 id="æ”¯æŒçš„èšåˆå‡½æ•°">æ”¯æŒçš„èšåˆå‡½æ•°</h4>

<table class="table">
<thead>
<tr>
<th>å‡½æ•°</th>
<th>æè¿°</th>
<th>ç¤ºä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>COUNT(*)</code></td>
<td>è®¡æ•°</td>
<td><code>SELECT COUNT(*)</code></td>
</tr>
<tr>
<th><code>SUM(expr)</code></th>
<th>æ±‚å’Œ</th>
<th><code>SELECT SUM(n.amount)</code></th>
</tr>
<tr>
<th><code>AVG(expr)</code></th>
<th>å¹³å‡å€¼</th>
<th><code>SELECT AVG(n.balance)</code></th>
</tr>
<tr>
<th><code>MIN(expr)</code></th>
<th>æœ€å°å€¼</th>
<th><code>SELECT MIN(n.price)</code></th>
</tr>
<tr>
<th><code>MAX(expr)</code></th>
<th>æœ€å¤§å€¼</th>
<th><code>SELECT MAX(n.score)</code></th>
</tr>
</tbody>
</table>

<h3 id="613-use-å›¾åˆ‡æ¢è¯­å¥-iso-gql-39075">6.13 USE å›¾åˆ‡æ¢è¯­å¥ (ISO GQL 39075)</h3>

<p>USE è¯­å¥ç”¨äºåˆ‡æ¢å½“å‰æŸ¥è¯¢çš„å›¾ä¸Šä¸‹æ–‡ã€‚</p>

<pre><code class="language-gql">
-- åˆ‡æ¢åˆ°æŒ‡å®šå›¾
USE GRAPH ethereum_mainnet

-- åˆ‡æ¢åˆ°å¦ä¸€ä¸ªå›¾
USE GRAPH polygon_network

-- åˆ‡æ¢åæ‰§è¡ŒæŸ¥è¯¢
USE GRAPH bsc_mainnet
MATCH (n:Account) RETURN n LIMIT 10
</code></pre>

<h3 id="614-å¤åˆæŸ¥è¯¢-iso-gql-39075">6.14 å¤åˆæŸ¥è¯¢ (ISO GQL 39075)</h3>

<p>æ”¯æŒ UNIONã€EXCEPTã€INTERSECTã€OTHERWISE æ“ä½œæ¥ç»„åˆå¤šä¸ªæŸ¥è¯¢ç»“æœã€‚</p>

<h4 id="union-è”åˆ">UNION è”åˆ</h4>

<pre><code class="language-gql">
-- è”åˆæŸ¥è¯¢ï¼ˆä¿ç•™é‡å¤ï¼‰
MATCH (a:Account) RETURN a
UNION ALL
MATCH (c:Contract) RETURN c

-- è”åˆæŸ¥è¯¢ï¼ˆå»é™¤é‡å¤ï¼‰
MATCH (a:Account) RETURN a
UNION
MATCH (b:Account) RETURN b
</code></pre>

<h4 id="except-å·®é›†">EXCEPT å·®é›†</h4>

<pre><code class="language-gql">
-- å·®é›†æŸ¥è¯¢
MATCH (a:Account) RETURN a
EXCEPT
MATCH (b:Account {status: "inactive"}) RETURN b
</code></pre>

<h4 id="intersect-äº¤é›†">INTERSECT äº¤é›†</h4>

<pre><code class="language-gql">
-- äº¤é›†æŸ¥è¯¢
MATCH (a:Account {type: "whale"}) RETURN a
INTERSECT
MATCH (b:Account {verified: true}) RETURN b
</code></pre>

<h4 id="otherwise-å›é€€">OTHERWISE å›é€€</h4>

<p>å½“ç¬¬ä¸€ä¸ªæŸ¥è¯¢è¿”å›ç©ºç»“æœæ—¶ï¼Œæ‰§è¡Œç¬¬äºŒä¸ªæŸ¥è¯¢ï¼š</p>

<pre><code class="language-gql">
-- å›é€€æŸ¥è¯¢
MATCH (n:Account {address: "0x..."}) RETURN n
OTHERWISE
MATCH (n:Account) RETURN n LIMIT 1
</code></pre>

<h3 id="615-session-ä¼šè¯ç®¡ç†-iso-gql-39075">6.15 SESSION ä¼šè¯ç®¡ç† (ISO GQL 39075)</h3>

<p>SESSION è¯­å¥ç”¨äºç®¡ç†æŸ¥è¯¢ä¼šè¯çš„å±æ€§ã€‚</p>

<h4 id="set-è®¾ç½®">SET è®¾ç½®</h4>

<pre><code class="language-gql">
-- è®¾ç½®å½“å‰æ¨¡å¼
SESSION SET SCHEMA main_schema

-- è®¾ç½®å½“å‰å›¾
SESSION SET GRAPH ethereum

-- è®¾ç½®å±æ€§å›¾
SESSION SET PROPERTY GRAPH financial_graph

-- è®¾ç½®å±æ€§å€¼
SESSION SET VALUE timeout = 30000
</code></pre>

<h4 id="reset-é‡ç½®">RESET é‡ç½®</h4>

<pre><code class="language-gql">
-- é‡ç½®æ¨¡å¼
SESSION RESET SCHEMA

-- é‡ç½®å›¾
SESSION RESET GRAPH

-- é‡ç½®æ‰€æœ‰
SESSION RESET ALL
</code></pre>

<h4 id="close-å…³é—­">CLOSE å…³é—­</h4>

<pre><code class="language-gql">
-- å…³é—­å½“å‰ä¼šè¯
SESSION CLOSE
</code></pre>

<h3 id="616-transaction-äº‹åŠ¡æ§åˆ¶-iso-gql-39075">6.16 TRANSACTION äº‹åŠ¡æ§åˆ¶ (ISO GQL 39075)</h3>

<p>äº‹åŠ¡æ§åˆ¶è¯­å¥ç”¨äºç®¡ç†æ•°æ®åº“äº‹åŠ¡ã€‚</p>

<pre><code class="language-gql">
-- å¼€å§‹è¯»å†™äº‹åŠ¡
START TRANSACTION READ WRITE

-- å¼€å§‹åªè¯»äº‹åŠ¡
START TRANSACTION READ ONLY

-- æäº¤äº‹åŠ¡
COMMIT

-- å›æ»šäº‹åŠ¡
ROLLBACK
</code></pre>

<h4 id="äº‹åŠ¡ä½¿ç”¨ç¤ºä¾‹">äº‹åŠ¡ä½¿ç”¨ç¤ºä¾‹</h4>

<pre><code class="language-gql">
-- å…¸å‹äº‹åŠ¡æµç¨‹
START TRANSACTION READ WRITE
INSERT (a:Account {address: "0x..."})
INSERT (a:Account {address: "0xAAA"})-[t:Transfer {amount: 1000}]-&gt;(b:Account {address: "0xBBB"})
COMMIT

-- å‘ç”Ÿé”™è¯¯æ—¶å›æ»š
START TRANSACTION READ WRITE
-- ... æ‰§è¡Œæ“ä½œ ...
ROLLBACK
</code></pre>

<h3 id="617-createdrop-graph-type-iso-gql-39075">6.17 CREATE/DROP GRAPH TYPE (ISO GQL 39075)</h3>

<p>å›¾ç±»å‹å®šä¹‰è¯­å¥ç”¨äºåˆ›å»ºå’Œåˆ é™¤å›¾ç±»å‹æ¨¡å¼ã€‚</p>

<h4 id="create-graph-type">CREATE GRAPH TYPE</h4>

<pre><code class="language-gql">
-- åˆ›å»ºå›¾ç±»å‹
CREATE GRAPH TYPE financial_network AS (
  (account:Account {address STRING, balance DECIMAL}),
  (contract:Contract {address STRING, code_hash STRING}),
  (account)-[transfer:Transfer {amount DECIMAL}]-&gt;(account)
)

-- ç®€å•å›¾ç±»å‹
CREATE GRAPH TYPE simple_graph AS (
  (node:Node {id INT, name STRING})
)
</code></pre>

<h4 id="drop-graph-type">DROP GRAPH TYPE</h4>

<pre><code class="language-gql">
-- åˆ é™¤å›¾ç±»å‹
DROP GRAPH TYPE financial_network

-- å¼ºåˆ¶åˆ é™¤ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
DROP GRAPH TYPE IF EXISTS old_schema
</code></pre>

<h3 id="618-é‡åŒ–è·¯å¾„æ¨¡å¼-iso-gql-39075">6.18 é‡åŒ–è·¯å¾„æ¨¡å¼ (ISO GQL 39075)</h3>

<p>æ”¯æŒå¯å˜é•¿åº¦è·¯å¾„å’Œè·¯å¾„æœç´¢å‰ç¼€ï¼Œä¸¥æ ¼éµå¾ª ISO GQL 39075 æ ‡å‡†ã€‚</p>

<h4 id="å¯å˜é•¿åº¦è·¯å¾„">å¯å˜é•¿åº¦è·¯å¾„</h4>

<pre><code class="language-gql">
-- 1 åˆ° 5 è·³
MATCH (a)-[:Transfer]-&gt;{1,5}(b) RETURN a, b

-- ç²¾ç¡® 3 è·³
MATCH (a)-[:Transfer]-&gt;{3}(b) RETURN a, b

-- è‡³å°‘ 2 è·³
MATCH (a)-[:Transfer]-&gt;{2,}(b) RETURN a, b

-- è‡³å¤š 10 è·³
MATCH (a)-[:Transfer]-&gt;{,10}(b) RETURN a, b

-- 1 è·³æˆ–æ›´å¤š (+ è¯­æ³•)
MATCH (a)-[:Transfer]-&gt;+(b) RETURN a, b

-- 0 è·³æˆ–æ›´å¤š (* è¯­æ³•)
MATCH (a)-[:Transfer]-&gt;*(b) RETURN a, b

-- 0 è·³æˆ– 1 è·³ (? è¯­æ³•)
MATCH (a)-[:Transfer]-&gt;?(b) RETURN a, b
</code></pre>

<h4 id="è·¯å¾„æœç´¢å‰ç¼€">è·¯å¾„æœç´¢å‰ç¼€</h4>

<p>ChainGraph æ”¯æŒ ISO GQL 39075 æ ‡å‡†çš„æ‰€æœ‰è·¯å¾„æœç´¢å‰ç¼€ï¼š</p>

<pre><code class="language-gql">
-- æœ€çŸ­è·¯å¾„ï¼ˆé»˜è®¤ä¸º ANY SHORTESTï¼‰
MATCH SHORTEST (a)-[:Transfer]-&gt;*(b) RETURN path

-- æ‰€æœ‰æœ€çŸ­è·¯å¾„
MATCH ALL SHORTEST (a)-[:Transfer]-&gt;*(b) RETURN path

-- ä»»æ„ä¸€æ¡è·¯å¾„
MATCH ANY (a)-[:Transfer]-&gt;{1,10}(b) RETURN path

-- ä»»æ„ k æ¡è·¯å¾„
MATCH ANY 5 (a)-[:Transfer]-&gt;{1,10}(b) RETURN path

-- ä»»æ„æœ€çŸ­è·¯å¾„
MATCH ANY SHORTEST (a)-[:Transfer]-&gt;*(b) RETURN path

-- å‰ k æ¡æœ€çŸ­è·¯å¾„
MATCH SHORTEST 3 (a)-[:Transfer]-&gt;*(b) RETURN path

-- æŒ‰é•¿åº¦åˆ†ç»„çš„å‰ k ç»„æœ€çŸ­è·¯å¾„
MATCH SHORTEST 2 GROUPS (a)-[:Transfer]-&gt;*(b) RETURN path

-- æ‰€æœ‰è·¯å¾„
MATCH ALL (a)-[:Transfer]-&gt;{1,5}(b) RETURN path
</code></pre>

<h3 id="619-show-è¯­å¥---æŸ¥çœ‹æ•°æ®åº“å¯¹è±¡">6.19 SHOW è¯­å¥ - æŸ¥çœ‹æ•°æ®åº“å¯¹è±¡</h3>

<p>SHOW è¯­å¥ç”¨äºåˆ—å‡ºæ•°æ®åº“ä¸­çš„å„ç±»å¯¹è±¡ã€‚</p>

<h4 id="show-graphs">SHOW GRAPHS</h4>

<pre><code class="language-gql">
-- æŸ¥çœ‹æ‰€æœ‰å›¾
SHOW GRAPHS

-- è¿”å›åˆ—: name, type, vertex_count, edge_count
</code></pre>

<h4 id="show-graph-types">SHOW GRAPH TYPES</h4>

<pre><code class="language-gql">
-- æŸ¥çœ‹æ‰€æœ‰å›¾ç±»å‹
SHOW GRAPH TYPES

-- è¿”å›åˆ—: name, definition
</code></pre>

<h4 id="show-schemas">SHOW SCHEMAS</h4>

<pre><code class="language-gql">
-- æŸ¥çœ‹æ‰€æœ‰æ¨¡å¼
SHOW SCHEMAS

-- è¿”å›åˆ—: name
</code></pre>

<h4 id="show-labels">SHOW LABELS</h4>

<pre><code class="language-gql">
-- æŸ¥çœ‹æ‰€æœ‰é¡¶ç‚¹æ ‡ç­¾
SHOW LABELS

-- è¿”å›åˆ—: label, description
</code></pre>

<h4 id="show-edge-types">SHOW EDGE TYPES</h4>

<pre><code class="language-gql">
-- æŸ¥çœ‹æ‰€æœ‰è¾¹ç±»å‹
SHOW EDGE TYPES
SHOW RELATIONSHIP TYPES

-- è¿”å›åˆ—: type, description
</code></pre>

<h4 id="show-property-keys">SHOW PROPERTY KEYS</h4>

<pre><code class="language-gql">
-- æŸ¥çœ‹æ‰€æœ‰å±æ€§é”®
SHOW PROPERTY KEYS

-- è¿”å›åˆ—: key, usage
</code></pre>

<h4 id="show-functions">SHOW FUNCTIONS</h4>

<pre><code class="language-gql">
-- æŸ¥çœ‹æ‰€æœ‰å†…ç½®å‡½æ•°
SHOW FUNCTIONS

-- è¿”å›åˆ—: name, signature, description
</code></pre>

<h4 id="show-procedures">SHOW PROCEDURES</h4>

<pre><code class="language-gql">
-- æŸ¥çœ‹æ‰€æœ‰å­˜å‚¨è¿‡ç¨‹
SHOW PROCEDURES

-- è¿”å›åˆ—: name, signature, description
</code></pre>

<h4 id="show-indexes">SHOW INDEXES</h4>

<pre><code class="language-gql">
-- æŸ¥çœ‹æ‰€æœ‰ç´¢å¼•
SHOW INDEXES

-- è¿”å›åˆ—: name, type, properties
</code></pre>

<h4 id="show-constraints">SHOW CONSTRAINTS</h4>

<pre><code class="language-gql">
-- æŸ¥çœ‹æ‰€æœ‰çº¦æŸ
SHOW CONSTRAINTS

-- è¿”å›åˆ—: name, type, definition
</code></pre>

<h3 id="620-describe-è¯­å¥---æŸ¥çœ‹å¯¹è±¡è¯¦æƒ…">6.20 DESCRIBE è¯­å¥ - æŸ¥çœ‹å¯¹è±¡è¯¦æƒ…</h3>

<p>DESCRIBE è¯­å¥ï¼ˆå¯ç¼©å†™ä¸º DESCï¼‰ç”¨äºæŸ¥çœ‹æ•°æ®åº“å¯¹è±¡çš„è¯¦ç»†ä¿¡æ¯ã€‚</p>

<h4 id="describe-graph">DESCRIBE GRAPH</h4>

<pre><code class="language-gql">
-- æŸ¥çœ‹å›¾çš„è¯¦ç»†ä¿¡æ¯
DESCRIBE GRAPH myGraph
DESC GRAPH myGraph

-- è¿”å›å±æ€§: name, type, vertex_count, edge_count, created_at
</code></pre>

<h4 id="describe-graph-type">DESCRIBE GRAPH TYPE</h4>

<pre><code class="language-gql">
-- æŸ¥çœ‹å›¾ç±»å‹çš„è¯¦ç»†ä¿¡æ¯
DESCRIBE GRAPH TYPE myGraphType
DESC GRAPH TYPE myType

-- è¿”å›åˆ—: element, type, properties
</code></pre>

<h4 id="describe-schema">DESCRIBE SCHEMA</h4>

<pre><code class="language-gql">
-- æŸ¥çœ‹æ¨¡å¼çš„è¯¦ç»†ä¿¡æ¯
DESCRIBE SCHEMA public

-- è¿”å›å±æ€§: name, graphs
</code></pre>

<h4 id="describe-label">DESCRIBE LABEL</h4>

<pre><code class="language-gql">
-- æŸ¥çœ‹é¡¶ç‚¹æ ‡ç­¾çš„è¯¦ç»†ä¿¡æ¯
DESCRIBE LABEL Account
DESCRIBE VERTEX TYPE Account

-- è¿”å›åˆ—: property, type, nullable
</code></pre>

<h4 id="describe-edge-type">DESCRIBE EDGE TYPE</h4>

<pre><code class="language-gql">
-- æŸ¥çœ‹è¾¹ç±»å‹çš„è¯¦ç»†ä¿¡æ¯
DESCRIBE EDGE TYPE Transfer
DESCRIBE RELATIONSHIP TYPE Transfer

-- è¿”å›åˆ—: property, type, nullable
</code></pre>

<hr>

<h2 id="7-å›¾ç®—æ³•">7. å›¾ç®—æ³•</h2>

<p>ChainGraph æä¾›å¤šç§å›¾ç®—æ³•ï¼Œå¯é€šè¿‡ GQL CALL è¯­å¥æˆ– REST API è°ƒç”¨ã€‚</p>

<h3 id="70-gql-call-è¯­æ³•-iso-gql-39075">7.0 GQL CALL è¯­æ³• (ISO GQL 39075)</h3>

<p>ChainGraph å®Œå…¨æ”¯æŒ ISO GQL 39075 æ ‡å‡†çš„ CALL è¿‡ç¨‹è°ƒç”¨è¯­æ³•ï¼š</p>

<pre><code class="language-gql">
-- åŸºæœ¬è¯­æ³•
CALL procedure_name(arg1, arg2, ...)

-- å¯é€‰è°ƒç”¨ï¼ˆä¸å­˜åœ¨æ—¶è¿”å›ç©ºç»“æœï¼‰
OPTIONAL CALL procedure_name(arg1, arg2, ...)
</code></pre>

<h4 id="å¯ç”¨è¿‡ç¨‹åˆ—è¡¨">å¯ç”¨è¿‡ç¨‹åˆ—è¡¨</h4>

<table class="table">
<thead>
<tr>
<th>è¿‡ç¨‹å</th>
<th>å‚æ•°</th>
<th>è¿”å›å­—æ®µ</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>shortest_path(source, target)</code></td>
<td>èµ·ç‚¹ID, ç»ˆç‚¹ID</td>
<td>path, length, total_weight</td>
<td>æœ€çŸ­è·¯å¾„</td>
</tr>
<tr>
<th><code>all<em>paths(source, target, max</em>depth?)</code></th>
<th>èµ·ç‚¹, ç»ˆç‚¹, å¯é€‰æ·±åº¦</th>
<th>path, length, total_weight</th>
<th>æ‰€æœ‰è·¯å¾„</th>
</tr>
<tr>
<th><code>trace(start, direction?, max_depth?)</code></th>
<th>èµ·ç‚¹, æ–¹å‘, æ·±åº¦</th>
<th>path, length, total_weight</th>
<th>é“¾è·¯è¿½è¸ª</th>
</tr>
<tr>
<th><code>max_flow(source, sink)</code></th>
<th>æºç‚¹, æ±‡ç‚¹</th>
<th>edge, flow</th>
<th>æœ€å¤§æµ</th>
</tr>
<tr>
<th><code>neighbors(vertex_id, direction?)</code></th>
<th>é¡¶ç‚¹ID, æ–¹å‘</th>
<th>direction, neighbor_id</th>
<th>é‚»å±…æŸ¥è¯¢</th>
</tr>
<tr>
<th><code>degree(vertex_id)</code></th>
<th>é¡¶ç‚¹ID</th>
<th>in<em>degree, out</em>degree</th>
<th>åº¦æ•°æŸ¥è¯¢</th>
</tr>
<tr>
<th><code>connected(source, target)</code></th>
<th>èµ·ç‚¹, ç»ˆç‚¹</th>
<th>connected</th>
<th>è¿é€šæ€§æ£€æµ‹</th>
</tr>
</tbody>
</table>

<h4 id="call-ç¤ºä¾‹">CALL ç¤ºä¾‹</h4>

<pre><code class="language-gql">
-- æœ€çŸ­è·¯å¾„
CALL shortest_path(1, 5)

-- æ‰€æœ‰è·¯å¾„ï¼ˆæœ€å¤§æ·±åº¦ 10ï¼‰
CALL all_paths(1, 5, 10)

-- æ­£å‘é“¾è·¯è¿½è¸ª
CALL trace(1, 'forward', 5)

-- åå‘é“¾è·¯è¿½è¸ª
CALL trace(1, 'backward', 5)

-- åŒå‘é“¾è·¯è¿½è¸ª
CALL trace(1, 'both', 5)

-- æœ€å¤§æµ
CALL max_flow(1, 100)

-- å‡ºè¾¹é‚»å±…
CALL neighbors(1, 'out')

-- å…¥è¾¹é‚»å±…
CALL neighbors(1, 'in')

-- æ‰€æœ‰é‚»å±…
CALL neighbors(1, 'both')

-- åº¦æ•°
CALL degree(1)

-- è¿é€šæ€§æ£€æµ‹
CALL connected(1, 100)

-- å¯é€‰è°ƒç”¨ï¼ˆé¡¶ç‚¹ä¸å­˜åœ¨æ—¶è¿”å›ç©ºï¼‰
OPTIONAL CALL shortest_path(1, 999999)
</code></pre>

<h3 id="71-è·¯å¾„è¿½è¸ª">7.1 è·¯å¾„è¿½è¸ª</h3>

<h4 id="æœ€çŸ­è·¯å¾„">æœ€çŸ­è·¯å¾„</h4>

<p>æ‰¾åˆ°ä¸¤ä¸ªé¡¶ç‚¹ä¹‹é—´çš„æœ€çŸ­è·¯å¾„ã€‚</p>

<p><strong>GQL è°ƒç”¨ï¼š</strong></p>
<pre><code class="language-gql">
CALL shortest_path(1, 100)
</code></pre>

<p><strong>REST API è°ƒç”¨ï¼š</strong></p>
<pre><code class="language-bash">
POST /algorithm/shortest-path
{
  "source": 1,
  "target": 100
}
</code></pre>

<p>å“åº”ï¼š</p>
<pre><code class="language-json">
{
  "success": true,
  "data": {
    "vertices": [1, 42, 78, 100],
    "edges": [101, 203, 305],
    "length": 3,
    "total_weight": 1500000.0
  }
}
</code></pre>

<h4 id="æ‰€æœ‰è·¯å¾„">æ‰€æœ‰è·¯å¾„</h4>

<p>æ‰¾åˆ°ä¸¤ä¸ªé¡¶ç‚¹ä¹‹é—´çš„æ‰€æœ‰è·¯å¾„ï¼ˆé™åˆ¶æ·±åº¦ï¼‰ã€‚</p>

<p><strong>GQL è°ƒç”¨ï¼š</strong></p>
<pre><code class="language-gql">
CALL all_paths(1, 100, 5)
</code></pre>

<p><strong>REST API è°ƒç”¨ï¼š</strong></p>
<pre><code class="language-bash">
POST /algorithm/all-paths
{
  "source": 1,
  "target": 100,
  "max_depth": 5,
  "k": 10  // æœ€å¤šè¿”å› 10 æ¡è·¯å¾„
}
</code></pre>

<h4 id="nè·³é‚»å±…">Nè·³é‚»å±…</h4>

<p>æŸ¥æ‰¾æŒ‡å®šé¡¶ç‚¹çš„ N è·³é‚»å±…ã€‚</p>

<p><strong>GQL è°ƒç”¨ï¼š</strong></p>
<pre><code class="language-gql">
CALL trace(1, 'forward', 3)
</code></pre>

<p><strong>REST API è°ƒç”¨ï¼š</strong></p>
<pre><code class="language-bash">
POST /algorithm/trace
{
  "start": 1,
  "direction": "forward",  // forward, backward, both
  "max_depth": 3
}
</code></pre>

<h3 id="72-æœ€å¤§æµç®—æ³•">7.2 æœ€å¤§æµç®—æ³•</h3>

<p>ä½¿ç”¨ Edmonds-Karp ç®—æ³•è®¡ç®—æœ€å¤§æµï¼Œç”¨äºåˆ†æèµ„é‡‘æµåŠ¨çš„æœ€å¤§é€šé‡ã€‚</p>

<p><strong>GQL è°ƒç”¨ï¼š</strong></p>
<pre><code class="language-gql">
CALL max_flow(1, 100)
</code></pre>

<p><strong>REST API è°ƒç”¨ï¼š</strong></p>
<pre><code class="language-bash">
POST /algorithm/max-flow
{
  "source": 1,
  "sink": 100
}
</code></pre>

<p>å“åº”ï¼š</p>
<pre><code class="language-json">
{
  "success": true,
  "data": {
    "value": 1500000.0,
    "flow": {
      "(1, 42)": 500000.0,
      "(1, 56)": 1000000.0,
      "(42, 100)": 500000.0,
      "(56, 100)": 1000000.0
    },
    "source_side": [1, 42, 56]
  }
}
</code></pre>

<h4 id="æœ€å¤§æµåº”ç”¨åœºæ™¯">æœ€å¤§æµåº”ç”¨åœºæ™¯</h4>

<ol>
<li><strong>èµ„é‡‘ç“¶é¢ˆåˆ†æ</strong>ï¼šæ‰¾å‡ºèµ„é‡‘æµåŠ¨çš„ç“¶é¢ˆè·¯å¾„</li>
<li><strong>æ´—é’±æ£€æµ‹</strong>ï¼šè¯†åˆ«èµ„é‡‘åˆ†æ•£å’Œæ±‡èšæ¨¡å¼</li>
<li><strong>é£é™©è¯„ä¼°</strong>ï¼šè¯„ä¼°åœ°å€ä¹‹é—´çš„èµ„é‡‘å…³è”å¼ºåº¦</li>
</ol>

<h3 id="73-é“¾è·¯è¿½è¸ª">7.3 é“¾è·¯è¿½è¸ª</h3>

<h4 id="æ­£å‘è¿½è¸ª">æ­£å‘è¿½è¸ª</h4>

<p>ä»æºåœ°å€å‡ºå‘ï¼Œè¿½è¸ªèµ„é‡‘æµå‘ã€‚</p>

<p><strong>GQL è°ƒç”¨ï¼š</strong></p>
<pre><code class="language-gql">
CALL trace(1, 'forward', 10)
</code></pre>

<p><strong>REST API è°ƒç”¨ï¼š</strong></p>
<pre><code class="language-bash">
POST /algorithm/trace
{
  "start": 1,
  "direction": "forward",
  "max_depth": 10
}
</code></pre>

<h4 id="åå‘è¿½è¸ª">åå‘è¿½è¸ª</h4>

<p>ä»ç›®æ ‡åœ°å€å‡ºå‘ï¼Œè¿½æº¯èµ„é‡‘æ¥æºã€‚</p>

<p><strong>GQL è°ƒç”¨ï¼š</strong></p>
<pre><code class="language-gql">
CALL trace(100, 'backward', 10)
</code></pre>

<p><strong>REST API è°ƒç”¨ï¼š</strong></p>
<pre><code class="language-bash">
POST /algorithm/trace
{
  "start": 100,
  "direction": "backward",
  "max_depth": 10
}
</code></pre>

<h4 id="åŒå‘è¿½è¸ª">åŒå‘è¿½è¸ª</h4>

<p>åŒæ—¶è¿›è¡Œæ­£å‘å’Œåå‘è¿½è¸ªã€‚</p>

<p><strong>GQL è°ƒç”¨ï¼š</strong></p>
<pre><code class="language-gql">
CALL trace(50, 'both', 5)
</code></pre>

<p><strong>REST API è°ƒç”¨ï¼š</strong></p>
<pre><code class="language-bash">
POST /algorithm/trace
{
  "start": 50,
  "direction": "both",
  "max_depth": 5
}
</code></pre>

<hr>

<h2 id="8-rest-api-å‚è€ƒ">8. REST API å‚è€ƒ</h2>

<h3 id="81-é€šç”¨è¯´æ˜">8.1 é€šç”¨è¯´æ˜</h3>

<h4 id="åŸºç¡€-url">åŸºç¡€ URL</h4>

<pre><code>
http://localhost:8080
</code></pre>

<h4 id="å“åº”æ ¼å¼">å“åº”æ ¼å¼</h4>

<p>æ‰€æœ‰ API è¿”å› JSON æ ¼å¼ï¼š</p>

<pre><code class="language-json">
{
  "success": true,
  "data": { ... },
  "error": null
}
</code></pre>

<p>é”™è¯¯å“åº”ï¼š</p>

<pre><code class="language-json">
{
  "success": false,
  "data": null,
  "error": "é”™è¯¯ä¿¡æ¯"
}
</code></pre>

<h3 id="82-å¥åº·æ£€æŸ¥">8.2 å¥åº·æ£€æŸ¥</h3>

<pre><code>
GET /health
</code></pre>

<p><strong>å“åº”ï¼š</strong></p>

<pre><code class="language-json">
{
  "status": "ok",
  "version": "0.1.0"
}
</code></pre>

<h3 id="83-æŸ¥è¯¢æ¥å£">8.3 æŸ¥è¯¢æ¥å£</h3>

<h4 id="æ‰§è¡Œ-gql-æŸ¥è¯¢">æ‰§è¡Œ GQL æŸ¥è¯¢</h4>

<pre><code>
POST /query
Content-Type: application/json
</code></pre>

<p><strong>è¯·æ±‚ä½“ï¼š</strong></p>

<pre><code class="language-json">
{
  "query": "MATCH (n:Account) RETURN n LIMIT 10"
}
</code></pre>

<p><strong>å“åº”ï¼š</strong></p>

<pre><code class="language-json">
{
  "success": true,
  "data": {
    "columns": ["n"],
    "rows": [
      [{"id": 1, "label": "Account", "address": "0x..."}]
    ],
    "stats": {
      "execution_time_ms": 5,
      "vertices_scanned": 1000,
      "edges_scanned": 0
    }
  }
}
</code></pre>

<h3 id="84-é¡¶ç‚¹æ¥å£">8.4 é¡¶ç‚¹æ¥å£</h3>

<h4 id="è·å–é¡¶ç‚¹">è·å–é¡¶ç‚¹</h4>

<pre><code>
GET /vertices/{id}
</code></pre>

<p><strong>å“åº”ï¼š</strong></p>

<pre><code class="language-json">
{
  "success": true,
  "data": {
    "id": 1,
    "label": "Account",
    "address": "0x742d35Cc...",
    "properties": {
      "balance": "1000000000000000000",
      "nonce": 42
    }
  }
}
</code></pre>

<h4 id="é€šè¿‡åœ°å€è·å–é¡¶ç‚¹">é€šè¿‡åœ°å€è·å–é¡¶ç‚¹</h4>

<pre><code>
GET /vertices/address/{address}
</code></pre>

<h3 id="85-è¾¹æ¥å£">8.5 è¾¹æ¥å£</h3>

<h4 id="è·å–è¾¹">è·å–è¾¹</h4>

<pre><code>
GET /edges/{id}
</code></pre>

<h4 id="è·å–é¡¶ç‚¹çš„å‡ºè¾¹">è·å–é¡¶ç‚¹çš„å‡ºè¾¹</h4>

<pre><code>
GET /vertices/{id}/outgoing
</code></pre>

<h4 id="è·å–é¡¶ç‚¹çš„å…¥è¾¹">è·å–é¡¶ç‚¹çš„å…¥è¾¹</h4>

<pre><code>
GET /vertices/{id}/incoming
</code></pre>

<h3 id="86-ç®—æ³•æ¥å£">8.6 ç®—æ³•æ¥å£</h3>

<h4 id="æœ€çŸ­è·¯å¾„">æœ€çŸ­è·¯å¾„</h4>

<pre><code>
POST /algorithm/shortest-path
</code></pre>

<p><strong>è¯·æ±‚ä½“ï¼š</strong></p>

<pre><code class="language-json">
{
  "source": 1,
  "target": 100
}
</code></pre>

<h4 id="æ‰€æœ‰è·¯å¾„">æ‰€æœ‰è·¯å¾„</h4>

<pre><code>
POST /algorithm/all-paths
</code></pre>

<p><strong>è¯·æ±‚ä½“ï¼š</strong></p>

<pre><code class="language-json">
{
  "source": 1,
  "target": 100,
  "max_depth": 5,
  "k": 10
}
</code></pre>

<h4 id="æœ€å¤§æµ">æœ€å¤§æµ</h4>

<pre><code>
POST /algorithm/max-flow
</code></pre>

<p><strong>è¯·æ±‚ä½“ï¼š</strong></p>

<pre><code class="language-json">
{
  "source": 1,
  "sink": 100
}
</code></pre>

<h4 id="é“¾è·¯è¿½è¸ª">é“¾è·¯è¿½è¸ª</h4>

<pre><code>
POST /algorithm/trace
</code></pre>

<p><strong>è¯·æ±‚ä½“ï¼š</strong></p>

<pre><code class="language-json">
{
  "start": 1,
  "direction": "forward",
  "max_depth": 10
}
</code></pre>

<h3 id="87-ç»Ÿè®¡æ¥å£">8.7 ç»Ÿè®¡æ¥å£</h3>

<pre><code>
GET /stats
</code></pre>

<p><strong>å“åº”ï¼š</strong></p>

<pre><code class="language-json">
{
  "success": true,
  "data": {
    "vertex_count": 1000000,
    "edge_count": 5000000,
    "buffer_pool_size": 1024,
    "cached_pages": 512
  }
}
</code></pre>

<hr>

<h2 id="9-æ•°æ®å¯¼å…¥">9. æ•°æ®å¯¼å…¥</h2>

<h3 id="91-csv-æ ¼å¼">9.1 CSV æ ¼å¼</h3>

<h4 id="é¡¶ç‚¹-csv">é¡¶ç‚¹ CSV</h4>

<pre><code class="language-csv">
address,label,balance,nonce
0x742d35Cc6634C0532925a3b844Bc9e7595f3fBb0,Account,1000000000000000000,42
0xdAC17F958D2ee523a2206206994597C13D831ec7,Contract,0,0
</code></pre>

<h4 id="è¾¹-csv">è¾¹ CSV</h4>

<pre><code class="language-csv">
from_address,to_address,label,amount,tx_hash,block_number
0x742d35Cc...,0xdAC17F958D2...,Transfer,1000000000000000000,0x...,15000000
</code></pre>

<h3 id="92-json-æ ¼å¼">9.2 JSON æ ¼å¼</h3>

<p>ä½¿ç”¨ JSONLï¼ˆæ¯è¡Œä¸€ä¸ª JSON å¯¹è±¡ï¼‰æ ¼å¼ã€‚</p>

<h4 id="é¡¶ç‚¹-jsonl">é¡¶ç‚¹ JSONL</h4>

<pre><code class="language-json">
{"type":"vertex","label":"Account","address":"0x742d35Cc...","properties":{"balance":"1000","nonce":42}}
{"type":"vertex","label":"Contract","address":"0xdAC17F958D2...","properties":{"name":"USDT"}}
</code></pre>

<h4 id="è¾¹-jsonl">è¾¹ JSONL</h4>

<pre><code class="language-json">
{"type":"edge","label":"Transfer","from":"0x742d35Cc...","to":"0xdAC17F958D2...","properties":{"amount":"1000","tx_hash":"0x..."}}
</code></pre>

<h3 id="93-å¯¼å…¥å‘½ä»¤">9.3 å¯¼å…¥å‘½ä»¤</h3>

<pre><code class="language-bash">
# CSV å¯¼å…¥
./chaingraph-import \
    --input vertices.csv \
    --format csv \
    --data-dir ./data \
    --batch-size 10000

# JSONL å¯¼å…¥ï¼ˆå¹¶è¡Œï¼‰
./chaingraph-import \
    --input data.jsonl \
    --format jsonl \
    --data-dir ./data \
    --parallel \
    --batch-size 50000
</code></pre>

<h3 id="94-å¯¼å…¥å‚æ•°">9.4 å¯¼å…¥å‚æ•°</h3>

<table class="table">
<thead>
<tr>
<th>å‚æ•°</th>
<th>é»˜è®¤å€¼</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--input</code></td>
<td>å¿…éœ€</td>
<td>è¾“å…¥æ–‡ä»¶è·¯å¾„</td>
</tr>
<tr>
<th><code>--format</code></th>
<th><code>csv</code></th>
<th>æ–‡ä»¶æ ¼å¼ï¼šcsv, jsonl</th>
</tr>
<tr>
<th><code>--data-dir</code></th>
<th><code>./data</code></th>
<th>æ•°æ®ç›®å½•</th>
</tr>
<tr>
<th><code>--batch-size</code></th>
<th><code>10000</code></th>
<th>æ‰¹æ¬¡å¤§å°</th>
</tr>
<tr>
<th><code>--parallel</code></th>
<th><code>false</code></th>
<th>å¯ç”¨å¹¶è¡Œå¯¼å…¥</th>
</tr>
</tbody>
</table>

<h3 id="95-å¯¼å…¥ç»Ÿè®¡">9.5 å¯¼å…¥ç»Ÿè®¡</h3>

<p>å¯¼å…¥å®Œæˆåä¼šæ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯ï¼š</p>

<pre><code>
å¯¼å…¥å®Œæˆï¼
â”œâ”€ é¡¶ç‚¹: 1,000,000
â”œâ”€ è¾¹: 5,000,000
â”œâ”€ é”™è¯¯: 0
â””â”€ è€—æ—¶: 120.5 ç§’
</code></pre>

<h3 id="96-gql-dml-å¯¼å…¥">9.6 GQL DML å¯¼å…¥</h3>

<p>é™¤äº†ä½¿ç”¨æ–‡ä»¶å¯¼å…¥å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ GQL INSERT è¯­å¥ç›´æ¥å¯¼å…¥æ•°æ®ï¼Œé€‚ç”¨äºå°æ‰¹é‡æ•°æ®æˆ–äº¤äº’å¼æ“ä½œã€‚</p>

<h4 id="äº¤äº’å¼å¯¼å…¥">äº¤äº’å¼å¯¼å…¥</h4>

<p>åœ¨ CLI ä¸­ç›´æ¥æ‰§è¡Œ INSERT è¯­å¥ï¼š</p>

<pre><code class="language-bash">
# å¯åŠ¨ CLI
./chaingraph-cli --data-dir ./data

# åœ¨äº¤äº’æ¨¡å¼ä¸­æ‰§è¡Œ INSERT
chaingraph&gt; INSERT (alice:Account {address: "0x742d35Cc6634C0532925a3b844Bc9e7595f3fBb0"})
inserted_vertices | inserted_edges
------------------------------
1 | 0

chaingraph&gt; INSERT (a:Account {address: "0x742d35Cc..."})-[t:Transfer {amount: 1000}]-&gt;(b:Account {address: "0x8ba1f1..."})
inserted_vertices | inserted_edges
------------------------------
2 | 1
</code></pre>

<h4 id="æ‰¹é‡å¯¼å…¥è„šæœ¬">æ‰¹é‡å¯¼å…¥è„šæœ¬</h4>

<p>å¯ä»¥é€šè¿‡ç®¡é“å°†å¤šæ¡è¯­å¥ä¼ å…¥ CLIï¼š</p>

<pre><code class="language-bash">
# ä»æ–‡ä»¶å¯¼å…¥
cat examples/sample_dml.gql | grep -v "^--" | ./chaingraph-cli --data-dir ./data

# ä½¿ç”¨ echo æ‰¹é‡å¯¼å…¥
echo 'INSERT (a:Account {address: "0xAAA..."})
INSERT (b:Account {address: "0xBBB..."})
INSERT (a:Account {address: "0xAAA..."})-[t:Transfer {amount: 500}]-&gt;(b:Account {address: "0xBBB..."})
stats
quit' | ./chaingraph-cli --data-dir ./data
</code></pre>

<h4 id="å•æ¡å‘½ä»¤æ‰§è¡Œ">å•æ¡å‘½ä»¤æ‰§è¡Œ</h4>

<p>ä½¿ç”¨ <code>-e</code> å‚æ•°æ‰§è¡Œå•æ¡ GQL è¯­å¥ï¼š</p>

<pre><code class="language-bash">
./chaingraph-cli --data-dir ./data -e 'INSERT (n:Account {address: "0x742d35Cc..."})'
</code></pre>

<h4 id="ç¤ºä¾‹æ•°æ®æ–‡ä»¶">ç¤ºä¾‹æ•°æ®æ–‡ä»¶</h4>

<p>é¡¹ç›®æä¾›äº†ç¤ºä¾‹æ•°æ®æ–‡ä»¶ <code>examples/sample_dml.gql</code>ï¼ŒåŒ…å«ï¼š</p>

<ul>
<li>5 ä¸ªè´¦æˆ·é¡¶ç‚¹ (Alice, Bob, Charlie, Dave, Eve)</li>
<li>2 ä¸ªåˆçº¦é¡¶ç‚¹ (Uniswap, AAVE)</li>
<li>èµ„é‡‘æµè½¬é“¾è·¯ (å½¢æˆç¯è·¯)</li>
<li>DeFi äº¤äº’äº¤æ˜“</li>
<li>å¯ç–‘èµ„é‡‘æ‹†åˆ†é“¾è·¯</li>
</ul>

<pre><code class="language-bash">
# æ‰§è¡Œç¤ºä¾‹å¯¼å…¥è„šæœ¬
./examples/import_sample_data.sh ./data
</code></pre>

<hr>

<h2 id="10-å‘½ä»¤è¡Œå·¥å…·">10. å‘½ä»¤è¡Œå·¥å…·</h2>

<h3 id="101-å¯åŠ¨-cli">10.1 å¯åŠ¨ CLI</h3>

<pre><code class="language-bash">
./chaingraph-cli --data-dir ./data
</code></pre>

<h3 id="102-äº¤äº’å¼å‘½ä»¤">10.2 äº¤äº’å¼å‘½ä»¤</h3>

<pre><code>
ChainGraph CLI v0.1.0
è¾“å…¥ GQL æŸ¥è¯¢æˆ–å‘½ä»¤ã€‚è¾“å…¥ 'help' æŸ¥çœ‹å¸®åŠ©ã€‚

chaingraph&gt; MATCH (n:Account) RETURN n LIMIT 5
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ID â”‚ Address                                     â”‚ Balance     â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1  â”‚ 0x742d35Cc6634C0532925a3b844Bc9e7595f3fBb0 â”‚ 1.0 ETH     â”‚
â”‚ 2  â”‚ 0xdAC17F958D2ee523a2206206994597C13D831ec7 â”‚ 0.0 ETH     â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

5 è¡Œç»“æœï¼Œè€—æ—¶ 2ms

chaingraph&gt; 
</code></pre>

<h3 id="103-å†…ç½®å‘½ä»¤">10.3 å†…ç½®å‘½ä»¤</h3>

<table class="table">
<thead>
<tr>
<th>å‘½ä»¤</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>help</code></td>
<td>æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯</td>
</tr>
<tr>
<th><code>stats</code></th>
<th>æ˜¾ç¤ºæ•°æ®åº“ç»Ÿè®¡</th>
</tr>
<tr>
<th><code>vertex <ID></code></th>
<th>æŸ¥çœ‹é¡¶ç‚¹è¯¦æƒ…</th>
</tr>
<tr>
<th><code>path <source> <target></code></th>
<th>å¿«é€ŸæŸ¥æ‰¾æœ€çŸ­è·¯å¾„</th>
</tr>
<tr>
<th><code>trace <start> [direction] [depth]</code></th>
<th>å¿«é€Ÿé“¾è·¯è¿½è¸ª</th>
</tr>
<tr>
<th><code>maxflow <source> <sink></code></th>
<th>å¿«é€Ÿè®¡ç®—æœ€å¤§æµ</th>
</tr>
<tr>
<th><code>clear</code></th>
<th>æ¸…å±</th>
</tr>
<tr>
<th><code>exit</code> æˆ– <code>quit</code></th>
<th>é€€å‡º</th>
</tr>
</tbody>
</table>

<h3 id="104-gql-call-è¿‡ç¨‹è°ƒç”¨">10.4 GQL CALL è¿‡ç¨‹è°ƒç”¨</h3>

<p>ChainGraph CLI å®Œå…¨æ”¯æŒ ISO GQL 39075 æ ‡å‡†çš„ CALL è¯­å¥ï¼š</p>

<pre><code class="language-bash">
# æŸ¥æ‰¾æœ€çŸ­è·¯å¾„
chaingraph&gt; CALL shortest_path(1, 100)

path                   | length | total_weight
-----------------------------------------------
1 -&gt; 42 -&gt; 78 -&gt; 100   | 3      | 1500000.0

1 è¡Œç»“æœ (è€—æ—¶ 1 ms)

# æŸ¥æ‰¾æ‰€æœ‰è·¯å¾„
chaingraph&gt; CALL all_paths(1, 100, 5)

path                   | length | total_weight
-----------------------------------------------
1 -&gt; 42 -&gt; 100         | 2      | 800000.0
1 -&gt; 42 -&gt; 78 -&gt; 100   | 3      | 1500000.0
1 -&gt; 56 -&gt; 89 -&gt; 100   | 3      | 1200000.0

3 è¡Œç»“æœ (è€—æ—¶ 2 ms)

# é“¾è·¯è¿½è¸ªï¼ˆæ­£å‘ï¼‰
chaingraph&gt; CALL trace(1, 'forward', 3)

path                          | length | total_weight
------------------------------------------------------
1 -&gt; 42                       | 1      | 100000.0
1 -&gt; 42 -&gt; 78                 | 2      | 250000.0
1 -&gt; 42 -&gt; 78 -&gt; 100          | 3      | 400000.0
1 -&gt; 56                       | 1      | 150000.0
...

# é“¾è·¯è¿½è¸ªï¼ˆåå‘ï¼‰
chaingraph&gt; CALL trace(100, 'backward', 3)

# æœ€å¤§æµè®¡ç®—
chaingraph&gt; CALL max_flow(1, 100)

edge            | flow
--------------------------
max_flow_value  | 1500000.0
1 -&gt; 42         | 500000.0
1 -&gt; 56         | 1000000.0
42 -&gt; 100       | 500000.0
56 -&gt; 100       | 1000000.0

5 è¡Œç»“æœ (è€—æ—¶ 5 ms)

# é‚»å±…æŸ¥è¯¢
chaingraph&gt; CALL neighbors(1, 'out')

direction | neighbor_id
------------------------
out       | 42
out       | 56
out       | 78

3 è¡Œç»“æœ (è€—æ—¶ 0 ms)

# åº¦æ•°æŸ¥è¯¢
chaingraph&gt; CALL degree(1)

in_degree | out_degree
----------------------
2         | 5

1 è¡Œç»“æœ (è€—æ—¶ 0 ms)

# è¿é€šæ€§æ£€æµ‹
chaingraph&gt; CALL connected(1, 100)

connected
---------
true

1 è¡Œç»“æœ (è€—æ—¶ 1 ms)

# å¯é€‰è°ƒç”¨ï¼ˆé¡¶ç‚¹ä¸å­˜åœ¨æ—¶ä¸æŠ¥é”™ï¼‰
chaingraph&gt; OPTIONAL CALL shortest_path(1, 999999)

result
------
æœªæ‰¾åˆ°è·¯å¾„

1 è¡Œç»“æœ (è€—æ—¶ 0 ms)
</code></pre>

<h3 id="105-å•æ¬¡æ‰§è¡Œ">10.5 å•æ¬¡æ‰§è¡Œ</h3>

<pre><code class="language-bash">
# æ‰§è¡Œå•ä¸ªæŸ¥è¯¢
./chaingraph-cli -e "MATCH (n:Account) RETURN n LIMIT 10"

# æ‰§è¡Œ CALL è¯­å¥
./chaingraph-cli -e "CALL shortest_path(1, 100)"

# æ‰§è¡Œé“¾è·¯è¿½è¸ª
./chaingraph-cli -e "CALL trace(1, 'forward', 5)"
</code></pre>

<hr>

<h2 id="11-æ€§èƒ½è°ƒä¼˜">11. æ€§èƒ½è°ƒä¼˜</h2>

<h3 id="111-ç¼“å†²æ± å¤§å°">11.1 ç¼“å†²æ± å¤§å°</h3>

<p>ç¼“å†²æ± æ˜¯å½±å“æ€§èƒ½çš„å…³é”®å› ç´ ã€‚</p>

<pre><code class="language-bash">
# å°è§„æ¨¡æ•°æ®ï¼ˆ&lt; 10 GBï¼‰
--buffer-size 512    # 2 MB

# ä¸­ç­‰è§„æ¨¡ï¼ˆ10-100 GBï¼‰
--buffer-size 4096   # 16 MB

# å¤§è§„æ¨¡æ•°æ®ï¼ˆ&gt; 100 GBï¼‰
--buffer-size 16384  # 64 MB
</code></pre>

<p><strong>ç»éªŒæ³•åˆ™</strong>ï¼šç¼“å†²æ± å¤§å°åº”ä¸ºå¯ç”¨å†…å­˜çš„ 10-25%ã€‚</p>

<h3 id="112-å­˜å‚¨ä¼˜åŒ–">11.2 å­˜å‚¨ä¼˜åŒ–</h3>

<ol>
<li><strong>ä½¿ç”¨ NVMe SSD</strong>ï¼šæ¯” SATA SSD å¿« 3-5 å€</li>
<li><strong>æ–‡ä»¶ç³»ç»Ÿ</strong>ï¼šæ¨è ext4 æˆ– xfs</li>
<li><strong>æŒ‚è½½é€‰é¡¹</strong>ï¼šä½¿ç”¨ <code>noatime</code> å‡å°‘å†™å…¥</li>
</ol>

<pre><code class="language-bash">
# æ¨èçš„æŒ‚è½½é€‰é¡¹
mount -o noatime,nodiratime /dev/nvme0n1 /data
</code></pre>

<h3 id="113-æŸ¥è¯¢ä¼˜åŒ–">11.3 æŸ¥è¯¢ä¼˜åŒ–</h3>

<ol>
<li><strong>ä½¿ç”¨ LIMIT</strong>ï¼šé¿å…è¿”å›è¿‡å¤šç»“æœ</li>
<li><strong>ç²¾ç¡®åŒ¹é…</strong>ï¼šä½¿ç”¨åœ°å€ç´¢å¼•</li>
<li><strong>é™åˆ¶è·¯å¾„æ·±åº¦</strong>ï¼šé¿å…è¿‡æ·±çš„è·¯å¾„æœç´¢</li>
</ol>

<pre><code class="language-gql">
-- å¥½çš„æŸ¥è¯¢
MATCH (n:Account {address: "0x..."}) RETURN n

-- é¿å…çš„æŸ¥è¯¢
MATCH (n) RETURN n  -- å…¨è¡¨æ‰«æ
</code></pre>

<h3 id="114-å¯¼å…¥ä¼˜åŒ–">11.4 å¯¼å…¥ä¼˜åŒ–</h3>

<ol>
<li><strong>å¢å¤§æ‰¹æ¬¡</strong>ï¼š<code>--batch-size 50000</code></li>
<li><strong>å¯ç”¨å¹¶è¡Œ</strong>ï¼š<code>--parallel</code></li>
<li><strong>ç¦ç”¨æ—¥å¿—</strong>ï¼šç”Ÿäº§ç¯å¢ƒå¯å…³é—­è¯¦ç»†æ—¥å¿—</li>
</ol>

<hr>

<h2 id="12-æœ€ä½³å®è·µ">12. æœ€ä½³å®è·µ</h2>

<h3 id="121-æ•°æ®å»ºæ¨¡">12.1 æ•°æ®å»ºæ¨¡</h3>

<ol>
<li><strong>åˆç†ä½¿ç”¨æ ‡ç­¾</strong>ï¼šä¸ºä¸åŒç±»å‹çš„å®ä½“ä½¿ç”¨ä¸åŒæ ‡ç­¾</li>
<li><strong>å±æ€§è§„èŒƒåŒ–</strong>ï¼šç»Ÿä¸€å±æ€§å‘½åå’Œç±»å‹</li>
<li><strong>é¿å…è¿‡åº¦åµŒå¥—</strong>ï¼šä¿æŒå›¾ç»“æ„æ‰å¹³</li>
</ol>

<h3 id="122-æŸ¥è¯¢å»ºè®®">12.2 æŸ¥è¯¢å»ºè®®</h3>

<pre><code class="language-gql">
-- âœ… æ¨èï¼šä½¿ç”¨ç´¢å¼•å­—æ®µ
MATCH (n:Account {address: "0x..."}) RETURN n

-- âŒ é¿å…ï¼šå…¨å›¾æ‰«æ
MATCH (n) WHERE n.balance &gt; 1000 RETURN n

-- âœ… æ¨èï¼šé™åˆ¶è·¯å¾„æ·±åº¦ (ISO GQL 39075 è¯­æ³•)
MATCH path = (a)-[:Transfer]-&gt;{1,3}(b) RETURN path

-- âŒ é¿å…ï¼šæ— é™æ·±åº¦
MATCH path = (a)-[:Transfer]-&gt;*(b) RETURN path
</code></pre>

<h3 id="123-è¿ç»´å»ºè®®">12.3 è¿ç»´å»ºè®®</h3>

<ol>
<li><strong>å®šæœŸå¤‡ä»½</strong>ï¼šå¤‡ä»½æ•°æ®ç›®å½•</li>
<li><strong>ç›‘æ§æŒ‡æ ‡</strong>ï¼šå…³æ³¨ç¼“å†²æ± å‘½ä¸­ç‡</li>
<li><strong>æ—¥å¿—åˆ†æ</strong>ï¼šå®šæœŸæ£€æŸ¥é”™è¯¯æ—¥å¿—</li>
</ol>

<hr>

<h2 id="13-æ•…éšœæ’é™¤">13. æ•…éšœæ’é™¤</h2>

<h3 id="131-å¸¸è§é—®é¢˜">13.1 å¸¸è§é—®é¢˜</h3>

<h4 id="æœåŠ¡æ— æ³•å¯åŠ¨">æœåŠ¡æ— æ³•å¯åŠ¨</h4>

<pre><code>
Error: Failed to bind to address
</code></pre>

<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šæ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨</p>

<pre><code class="language-bash">
lsof -i :8080
</code></pre>

<h4 id="å†…å­˜ä¸è¶³">å†…å­˜ä¸è¶³</h4>

<pre><code>
Error: Out of memory
</code></pre>

<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šå‡å°ç¼“å†²æ± å¤§å°æˆ–å¢åŠ ç³»ç»Ÿå†…å­˜</p>

<h4 id="ç£ç›˜ç©ºé—´ä¸è¶³">ç£ç›˜ç©ºé—´ä¸è¶³</h4>

<pre><code>
Error: No space left on device
</code></pre>

<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šæ¸…ç†ç£ç›˜ç©ºé—´æˆ–è¿ç§»æ•°æ®ç›®å½•</p>

<h3 id="132-æ€§èƒ½é—®é¢˜">13.2 æ€§èƒ½é—®é¢˜</h3>

<h4 id="æŸ¥è¯¢ç¼“æ…¢">æŸ¥è¯¢ç¼“æ…¢</h4>

<ol>
<li>æ£€æŸ¥ç¼“å†²æ± å‘½ä¸­ç‡ï¼š<code>GET /stats</code></li>
<li>ä¼˜åŒ–æŸ¥è¯¢è¯­å¥</li>
<li>å¢åŠ ç¼“å†²æ± å¤§å°</li>
</ol>

<h4 id="å¯¼å…¥ç¼“æ…¢">å¯¼å…¥ç¼“æ…¢</h4>

<ol>
<li>æ£€æŸ¥ç£ç›˜ I/O</li>
<li>å¢å¤§æ‰¹æ¬¡å¤§å°</li>
<li>å¯ç”¨å¹¶è¡Œå¯¼å…¥</li>
</ol>

<h3 id="133-æ•°æ®é—®é¢˜">13.3 æ•°æ®é—®é¢˜</h3>

<h4 id="æ•°æ®æ ¡éªŒå¤±è´¥">æ•°æ®æ ¡éªŒå¤±è´¥</h4>

<pre><code>
Error: Checksum mismatch
</code></pre>

<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šæ•°æ®å¯èƒ½å·²æŸåï¼Œä»å¤‡ä»½æ¢å¤</p>

<hr>

<h2 id="é™„å½•">é™„å½•</h2>

<h3 id="a-gql-è¯­æ³•å‚è€ƒ">A. GQL è¯­æ³•å‚è€ƒ</h3>

<pre><code class="language-bnf">
&lt;statement&gt;     ::= &lt;match-stmt&gt; | &lt;insert-stmt&gt; | &lt;delete-stmt&gt; | &lt;update-stmt&gt;

&lt;match-stmt&gt;    ::= MATCH &lt;pattern&gt; [WHERE &lt;expression&gt;] RETURN &lt;return-items&gt;
                    [ORDER BY &lt;order-items&gt;] [SKIP &lt;integer&gt;] [LIMIT &lt;integer&gt;]

&lt;pattern&gt;       ::= &lt;path-pattern&gt; (',' &lt;path-pattern&gt;)*

&lt;path-pattern&gt;  ::= &lt;node-pattern&gt; (&lt;relationship-pattern&gt; &lt;node-pattern&gt;)*

&lt;node-pattern&gt;  ::= '(' [&lt;variable&gt;] [':' &lt;label&gt;] [&lt;properties&gt;] ')'

&lt;relationship&gt;  ::= '-[' [&lt;variable&gt;] [':' &lt;label&gt;] ['*' &lt;length&gt;] [&lt;properties&gt;] ']-&gt;'
                  | '&lt;-[' [&lt;variable&gt;] [':' &lt;label&gt;] ['*' &lt;length&gt;] [&lt;properties&gt;] ']-'

&lt;properties&gt;    ::= '{' &lt;property&gt; (',' &lt;property&gt;)* '}'

&lt;property&gt;      ::= &lt;identifier&gt; ':' &lt;value&gt;
</code></pre>

<h3 id="b-é”™è¯¯ä»£ç ">B. é”™è¯¯ä»£ç </h3>

<table class="table">
<thead>
<tr>
<th>ä»£ç </th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>E001</code></td>
<td>é¡¶ç‚¹ä¸å­˜åœ¨</td>
</tr>
<tr>
<th><code>E002</code></th>
<th>è¾¹ä¸å­˜åœ¨</th>
</tr>
<tr>
<th><code>E003</code></th>
<th>å­˜å‚¨é”™è¯¯</th>
</tr>
<tr>
<th><code>E004</code></th>
<th>è§£æé”™è¯¯</th>
</tr>
<tr>
<th><code>E005</code></th>
<th>æŸ¥è¯¢é”™è¯¯</th>
</tr>
<tr>
<th><code>E006</code></th>
<th>æ ¡éªŒå’Œä¸åŒ¹é…</th>
</tr>
<tr>
<th><code>E007</code></th>
<th>æœåŠ¡å™¨é”™è¯¯</th>
</tr>
</tbody>
</table>

<h3 id="c-ç‰ˆæœ¬å†å²">C. ç‰ˆæœ¬å†å²</h3>

<table class="table">
<thead>
<tr>
<th>ç‰ˆæœ¬</th>
<th>æ—¥æœŸ</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>0.1.0</td>
<td>2024-12</td>
<td>åˆå§‹ç‰ˆæœ¬</td>
</tr>
</tbody>
</table>

<hr>

<p>Â© 2024 ChainGraph. All rights reserved.</p>

        </main>
    </div>
    <script>
        // ç”Ÿæˆç›®å½•
        document.addEventListener('DOMContentLoaded', function() {
            const toc = document.getElementById('toc');
            const headings = document.querySelectorAll('h1, h2, h3');
            let tocHtml = '<ul>';
            headings.forEach(function(heading) {
                const level = parseInt(heading.tagName.charAt(1));
                const text = heading.textContent;
                const id = heading.id;
                const indent = (level - 1) * 15;
                tocHtml += `<li style="margin-left: ${indent}px"><a href="#${id}">${text}</a></li>`;
            });
            tocHtml += '</ul>';
            toc.innerHTML = tocHtml;
        });
    </script>
</body>
</html>